{"version":3,"sources":["../src/FontLoader.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;AAGA,IAAM,UAAU,GAAG,uBAAU,YAAV,KAA2B,MAA9C;AACA,IAAM,iBAAiB,GAAG,uBAAU,YAAV,KAA2B,YAA3B,IAA2C,sBAAS,EAAT,KAAgB,KAArF;;AAEM,SAAU,sBAAV,CAAiC,IAAjC,EAA6C;AACjD,SACE,CAAC,UAAU,IAAI,iBAAf,KACA,CAAC,uBAAU,WAAV,CAAsB,QAAtB,CAA+B,IAA/B,CADD,IAEA,IAAI,KAAK,QAFT,IAGA,CAAC,IAAI,CAAC,QAAL,CAAc,uBAAU,SAAxB,CAJH;AAMD;;AAEK,SAAU,iBAAV,CAA4B,MAA5B,EAA8C;AAClD,MAAI,MAAM,YAAY,gBAAtB,EAA6B;AAC3B,WAAO,MAAP;AACD;;AAED,MAAI,OAAO,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,WAAO,iBAAM,OAAN,CAAc,MAAd,CAAP;AACD,GAFD,MAEO,IAAI,OAAO,MAAP,KAAkB,QAAtB,EAAgC;AACrC,WAAO,iBAAM,UAAN,CAAiB,MAAjB,CAAP;AACD,GAFM,MAEA,IAAI,OAAO,MAAP,KAAkB,QAAlB,IAA8B,OAAO,MAAM,CAAC,GAAd,KAAsB,WAAxD,EAAqE;AAC1E,WAAO,iBAAiB,CAAC,MAAM,CAAC,GAAR,CAAxB;AACD;;AAKD,SAAO,MAAP;AACD;;AAEM,SAAe,mBAAf,CACL,IADK,EAEL,KAFK;AAAA;AAAA;AAAA;AAAA;AAAA;AAIC,UAAA,KAJD,GAIS,KAJT;;AAAA,cAKA,KAAK,CAAC,aALN;AAAA;AAAA;AAAA;;AAAA,gBAMG,IAAI,gBAAJ,oBAEJ,mFAFI,CANH;;AAAA;AAAA;AAAA,4CAYC,KAAK,CAAC,aAAN,EAZD;;AAAA;AAAA,cAaA,KAAK,CAAC,UAbN;AAAA;AAAA;AAAA;;AAAA,gBAcG,IAAI,gBAAJ,0DAAqE,IAArE,QAdH;;AAAA;AAAA;AAAA,4CAgBC,wBAAe,SAAf,CAAyB,iBAAiB,CAAC,IAAD,CAA1C,EAAkD,KAAK,CAAC,QAAxD,CAhBD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAmBD,SAAU,iBAAV,CAA4B,IAA5B,EAAwC;AAC5C,MAAI,sBAAsB,CAAC,IAAD,CAA1B,EAAkC;AAChC,WAAU,uBAAU,SAApB,SAAiC,IAAjC;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF","sourcesContent":["import { CodedError } from '@unimodules/core';\nimport { Asset } from 'expo-asset';\nimport Constants from 'expo-constants';\nimport { Platform } from 'react-native';\n\nimport ExpoFontLoader from './ExpoFontLoader';\nimport { FontResource, FontSource } from './Font.types';\n\nconst isInClient = Constants.appOwnership === 'expo';\nconst isInIOSStandalone = Constants.appOwnership === 'standalone' && Platform.OS === 'ios';\n\nexport function fontFamilyNeedsScoping(name: string): boolean {\n  return (\n    (isInClient || isInIOSStandalone) &&\n    !Constants.systemFonts.includes(name) &&\n    name !== 'System' &&\n    !name.includes(Constants.sessionId)\n  );\n}\n\nexport function getAssetForSource(source: FontSource): Asset | FontResource {\n  if (source instanceof Asset) {\n    return source;\n  }\n\n  if (typeof source === 'string') {\n    return Asset.fromURI(source);\n  } else if (typeof source === 'number') {\n    return Asset.fromModule(source);\n  } else if (typeof source === 'object' && typeof source.uri !== 'undefined') {\n    return getAssetForSource(source.uri);\n  }\n\n  // @ts-ignore Error: Type 'string' is not assignable to type 'Asset'\n  // We can't have a string here, we would have thrown an error if !isWeb\n  // or returned Asset.fromModule if isWeb.\n  return source;\n}\n\nexport async function loadSingleFontAsync(\n  name: string,\n  input: Asset | FontResource\n): Promise<void> {\n  const asset = input as Asset;\n  if (!asset.downloadAsync) {\n    throw new CodedError(\n      `ERR_FONT_SOURCE`,\n      '`loadSingleFontAsync` expected resource of type `Asset` from expo-asset on native'\n    );\n  }\n\n  await asset.downloadAsync();\n  if (!asset.downloaded) {\n    throw new CodedError(`ERR_DOWNLOAD`, `Failed to download asset for font \"${name}\"`);\n  }\n  await ExpoFontLoader.loadAsync(getNativeFontName(name), asset.localUri);\n}\n\nexport function getNativeFontName(name: string): string {\n  if (fontFamilyNeedsScoping(name)) {\n    return `${Constants.sessionId}-${name}`;\n  } else {\n    return name;\n  }\n}\n"],"sourceRoot":""}