8a8fdfe39600c54e076e4501a28d4828
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault2(require("@babel/runtime/helpers/defineProperty"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.FABGroup = exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _color = _interopRequireDefault(require("color"));

var _FAB = _interopRequireDefault(require("./FAB"));

var _Text = _interopRequireDefault(require("../Typography/Text"));

var _Card = _interopRequireDefault(require("../Card/Card"));

var _theming = require("../../core/theming");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

var FABGroup = function FABGroup(_ref) {
  var actions = _ref.actions,
      icon = _ref.icon,
      open = _ref.open,
      _onPress = _ref.onPress,
      accessibilityLabel = _ref.accessibilityLabel,
      theme = _ref.theme,
      style = _ref.style,
      fabStyle = _ref.fabStyle,
      visible = _ref.visible,
      testID = _ref.testID,
      onStateChange = _ref.onStateChange,
      colorProp = _ref.color;

  var _React$useRef = React.useRef(new _reactNative.Animated.Value(0)),
      backdrop = _React$useRef.current;

  var animations = React.useRef(actions.map(function () {
    return new _reactNative.Animated.Value(open ? 1 : 0);
  }));

  var _React$useState = React.useState(null),
      _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
      prevActions = _React$useState2[0],
      setPrevActions = _React$useState2[1];

  var scale = theme.animation.scale;
  React.useEffect(function () {
    if (open) {
      _reactNative.Animated.parallel([_reactNative.Animated.timing(backdrop, {
        toValue: 1,
        duration: 250 * scale,
        useNativeDriver: true
      }), _reactNative.Animated.stagger(50 * scale, animations.current.map(function (animation) {
        return _reactNative.Animated.timing(animation, {
          toValue: 1,
          duration: 150 * scale,
          useNativeDriver: true
        });
      }).reverse())]).start();
    } else {
      _reactNative.Animated.parallel([_reactNative.Animated.timing(backdrop, {
        toValue: 0,
        duration: 200 * scale,
        useNativeDriver: true
      })].concat((0, _toConsumableArray2.default)(animations.current.map(function (animation) {
        return _reactNative.Animated.timing(animation, {
          toValue: 0,
          duration: 150 * scale,
          useNativeDriver: true
        });
      })))).start();
    }
  }, [open, actions, backdrop, scale]);

  var close = function close() {
    return onStateChange({
      open: false
    });
  };

  var toggle = function toggle() {
    return onStateChange({
      open: !open
    });
  };

  var colors = theme.colors;
  var labelColor = theme.dark ? colors.text : (0, _color.default)(colors.text).fade(0.54).rgb().string();
  var backdropOpacity = open ? backdrop.interpolate({
    inputRange: [0, 0.5, 1],
    outputRange: [0, 1, 1]
  }) : backdrop;
  var opacities = animations.current;
  var scales = opacities.map(function (opacity) {
    return open ? opacity.interpolate({
      inputRange: [0, 1],
      outputRange: [0.8, 1]
    }) : 1;
  });

  if (actions.length !== (prevActions === null || prevActions === void 0 ? void 0 : prevActions.length)) {
    animations.current = actions.map(function (_, i) {
      return animations.current[i] || new _reactNative.Animated.Value(open ? 1 : 0);
    });
    setPrevActions(actions);
  }

  return React.createElement(_reactNative.View, {
    pointerEvents: "box-none",
    style: [styles.container, style]
  }, React.createElement(_reactNative.TouchableWithoutFeedback, {
    onPress: close
  }, React.createElement(_reactNative.Animated.View, {
    pointerEvents: open ? 'auto' : 'none',
    style: [styles.backdrop, {
      opacity: backdropOpacity,
      backgroundColor: colors.backdrop
    }]
  })), React.createElement(_reactNative.SafeAreaView, {
    pointerEvents: "box-none",
    style: styles.safeArea
  }, React.createElement(_reactNative.View, {
    pointerEvents: open ? 'box-none' : 'none'
  }, actions.map(function (it, i) {
    return React.createElement(_reactNative.View, {
      key: i,
      style: [styles.item, {
        marginHorizontal: typeof it.small === 'undefined' || it.small ? 24 : 16
      }],
      pointerEvents: open ? 'box-none' : 'none'
    }, it.label && React.createElement(_reactNative.View, null, React.createElement(_Card.default, {
      style: [styles.label, {
        transform: [{
          scale: scales[i]
        }],
        opacity: opacities[i]
      }],
      onPress: function onPress() {
        it.onPress();
        close();
      },
      accessibilityLabel: it.accessibilityLabel !== 'undefined' ? it.accessibilityLabel : it.label,
      accessibilityTraits: "button",
      accessibilityComponentType: "button",
      accessibilityRole: "button"
    }, React.createElement(_Text.default, {
      style: {
        color: labelColor
      }
    }, it.label))), React.createElement(_FAB.default, {
      small: typeof it.small !== 'undefined' ? it.small : true,
      icon: it.icon,
      color: it.color,
      style: [{
        transform: [{
          scale: scales[i]
        }],
        opacity: opacities[i],
        backgroundColor: theme.colors.surface
      }, it.style],
      onPress: function onPress() {
        it.onPress();
        close();
      },
      accessibilityLabel: typeof it.accessibilityLabel !== 'undefined' ? it.accessibilityLabel : it.label,
      accessibilityTraits: "button",
      accessibilityComponentType: "button",
      accessibilityRole: "button",
      testID: it.testID,
      visible: open
    }));
  })), React.createElement(_FAB.default, {
    onPress: function onPress() {
      _onPress === null || _onPress === void 0 ? void 0 : _onPress();
      toggle();
    },
    icon: icon,
    color: colorProp,
    accessibilityLabel: accessibilityLabel,
    accessibilityTraits: "button",
    accessibilityComponentType: "button",
    accessibilityRole: "button",
    accessibilityState: {
      expanded: open
    },
    style: [styles.fab, fabStyle],
    visible: visible,
    testID: testID
  })));
};

FABGroup.displayName = 'FAB.Group';

var _default = (0, _theming.withTheme)(FABGroup);

exports.default = _default;
var FABGroupWithTheme = (0, _theming.withTheme)(FABGroup);
exports.FABGroup = FABGroupWithTheme;

var styles = _reactNative.StyleSheet.create({
  safeArea: {
    alignItems: 'flex-end'
  },
  container: _objectSpread(_objectSpread({}, _reactNative.StyleSheet.absoluteFillObject), {}, {
    justifyContent: 'flex-end'
  }),
  fab: {
    marginHorizontal: 16,
    marginBottom: 16,
    marginTop: 0
  },
  backdrop: _objectSpread({}, _reactNative.StyleSheet.absoluteFillObject),
  label: {
    borderRadius: 5,
    paddingHorizontal: 12,
    paddingVertical: 6,
    marginVertical: 8,
    marginHorizontal: 16,
    elevation: 2
  },
  item: {
    marginBottom: 16,
    flexDirection: 'row',
    justifyContent: 'flex-end',
    alignItems: 'center'
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZBQkdyb3VwLnRzeCJdLCJuYW1lcyI6WyJGQUJHcm91cCIsImNvbG9yIiwiY29sb3JQcm9wIiwiY3VycmVudCIsImJhY2tkcm9wIiwiUmVhY3QiLCJBbmltYXRlZCIsImFuaW1hdGlvbnMiLCJhY3Rpb25zIiwib3BlbiIsInNjYWxlIiwidGhlbWUiLCJ0b1ZhbHVlIiwiZHVyYXRpb24iLCJ1c2VOYXRpdmVEcml2ZXIiLCJhbmltYXRpb24iLCJjbG9zZSIsIm9uU3RhdGVDaGFuZ2UiLCJ0b2dnbGUiLCJjb2xvcnMiLCJsYWJlbENvbG9yIiwiYmFja2Ryb3BPcGFjaXR5IiwiaW5wdXRSYW5nZSIsIm91dHB1dFJhbmdlIiwib3BhY2l0aWVzIiwic2NhbGVzIiwib3BhY2l0eSIsInByZXZBY3Rpb25zIiwic2V0UHJldkFjdGlvbnMiLCJzdHlsZXMiLCJiYWNrZ3JvdW5kQ29sb3IiLCJzYWZlQXJlYSIsIm1hcmdpbkhvcml6b250YWwiLCJpdCIsInRyYW5zZm9ybSIsInN1cmZhY2UiLCJvblByZXNzIiwiZXhwYW5kZWQiLCJ0ZXN0SUQiLCJGQUJHcm91cFdpdGhUaGVtZSIsImFsaWduSXRlbXMiLCJjb250YWluZXIiLCJTdHlsZVNoZWV0IiwianVzdGlmeUNvbnRlbnQiLCJmYWIiLCJtYXJnaW5Cb3R0b20iLCJtYXJnaW5Ub3AiLCJhYnNvbHV0ZUZpbGxPYmplY3QiLCJsYWJlbCIsImJvcmRlclJhZGl1cyIsInBhZGRpbmdIb3Jpem9udGFsIiwicGFkZGluZ1ZlcnRpY2FsIiwibWFyZ2luVmVydGljYWwiLCJlbGV2YXRpb24iLCJpdGVtIiwiZmxleERpcmVjdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsS0FBQSxHQUFBLHVCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsWUFBQSxHQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUE7O0FBU0EsSUFBQSxNQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFB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QUFFO0FBTk4sR0FoQndCO0FBd0IvQkMsRUFBQUEsSUFBSSxFQUFFO0FBQ0pULElBQUFBLFlBQVksRUFEUixFQUFBO0FBRUpVLElBQUFBLGFBQWEsRUFGVCxLQUFBO0FBR0paLElBQUFBLGNBQWMsRUFIVixVQUFBO0FBSUpILElBQUFBLFVBQVUsRUFBRTtBQUpSO0FBeEJ5QixDQUFsQixDQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgU3R5bGVQcm9wLFxuICBTdHlsZVNoZWV0LFxuICBBbmltYXRlZCxcbiAgU2FmZUFyZWFWaWV3LFxuICBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2ssXG4gIFZpZXcsXG4gIFZpZXdTdHlsZSxcbn0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBjb2xvciBmcm9tICdjb2xvcic7XG5pbXBvcnQgRkFCIGZyb20gJy4vRkFCJztcbmltcG9ydCBUZXh0IGZyb20gJy4uL1R5cG9ncmFwaHkvVGV4dCc7XG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9DYXJkL0NhcmQnO1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnLi4vLi4vY29yZS90aGVtaW5nJztcbmltcG9ydCB0eXBlIHsgSWNvblNvdXJjZSB9IGZyb20gJy4uL0ljb24nO1xuXG50eXBlIFByb3BzID0ge1xuICAvKipcbiAgICogQWN0aW9uIGl0ZW1zIHRvIGRpc3BsYXkgaW4gdGhlIGZvcm0gb2YgYSBzcGVlZCBkaWFsLlxuICAgKiBBbiBhY3Rpb24gaXRlbSBzaG91bGQgY29udGFpbiB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAqIC0gYGljb25gOiBpY29uIHRvIGRpc3BsYXkgKHJlcXVpcmVkKVxuICAgKiAtIGBsYWJlbGA6IG9wdGlvbmFsIGxhYmVsIHRleHRcbiAgICogLSBgYWNjZXNzaWJpbGl0eUxhYmVsYDogYWNjZXNzaWJpbGl0eSBsYWJlbCBmb3IgdGhlIGFjdGlvbiwgdXNlcyBsYWJlbCBieSBkZWZhdWx0IGlmIHNwZWNpZmllZFxuICAgKiAtIGBjb2xvcmA6IGN1c3RvbSBpY29uIGNvbG9yIG9mIHRoZSBhY3Rpb24gaXRlbVxuICAgKiAtIGBzdHlsZWA6IHBhc3MgYWRkaXRpb25hbCBzdHlsZXMgZm9yIHRoZSBmYWIgaXRlbSwgZm9yIGV4YW1wbGUsIGBiYWNrZ3JvdW5kQ29sb3JgXG4gICAqIC0gYHNtYWxsYDogYm9vbGVhbiBkZXNjcmliaW5nIHdoZXRoZXIgc21hbGwgb3Igbm9ybWFsIHNpemVkIEZBQiBpcyByZW5kZXJlZC4gRGVmYXVsdHMgdG8gYHRydWVgXG4gICAqIC0gYG9uUHJlc3NgOiBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCB3aGVuIGBGQUJgIGlzIHByZXNzZWQgKHJlcXVpcmVkKVxuICAgKi9cbiAgYWN0aW9uczogQXJyYXk8e1xuICAgIGljb246IEljb25Tb3VyY2U7XG4gICAgbGFiZWw/OiBzdHJpbmc7XG4gICAgY29sb3I/OiBzdHJpbmc7XG4gICAgYWNjZXNzaWJpbGl0eUxhYmVsPzogc3RyaW5nO1xuICAgIHN0eWxlPzogU3R5bGVQcm9wPFZpZXdTdHlsZT47XG4gICAgc21hbGw/OiBib29sZWFuO1xuICAgIG9uUHJlc3M6ICgpID0+IHZvaWQ7XG4gICAgdGVzdElEPzogc3RyaW5nO1xuICB9PjtcbiAgLyoqXG4gICAqIEljb24gdG8gZGlzcGxheSBmb3IgdGhlIGBGQUJgLlxuICAgKiBZb3UgY2FuIHRvZ2dsZSBpdCBiYXNlZCBvbiB3aGV0aGVyIHRoZSBzcGVlZCBkaWFsIGlzIG9wZW4gdG8gZGlzcGxheSBhIGRpZmZlcmVudCBpY29uLlxuICAgKi9cbiAgaWNvbjogSWNvblNvdXJjZTtcbiAgLyoqXG4gICAqIEFjY2Vzc2liaWxpdHkgbGFiZWwgZm9yIHRoZSBGQUIuIFRoaXMgaXMgcmVhZCBieSB0aGUgc2NyZWVuIHJlYWRlciB3aGVuIHRoZSB1c2VyIHRhcHMgdGhlIEZBQi5cbiAgICovXG4gIGFjY2Vzc2liaWxpdHlMYWJlbD86IHN0cmluZztcbiAgLyoqXG4gICAqIEN1c3RvbSBjb2xvciBmb3IgdGhlIGBGQUJgLlxuICAgKi9cbiAgY29sb3I/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0byBleGVjdXRlIG9uIHByZXNzaW5nIHRoZSBgRkFCYC5cbiAgICovXG4gIG9uUHJlc3M/OiAoKSA9PiB2b2lkO1xuICAvKipcbiAgICogV2hldGhlciB0aGUgc3BlZWQgZGlhbCBpcyBvcGVuLlxuICAgKi9cbiAgb3BlbjogYm9vbGVhbjtcbiAgLyoqXG4gICAqIENhbGxiYWNrIHdoaWNoIGlzIGNhbGxlZCBvbiBvcGVuaW5nIGFuZCBjbG9zaW5nIHRoZSBzcGVlZCBkaWFsLlxuICAgKiBUaGUgb3BlbiBzdGF0ZSBuZWVkcyB0byBiZSB1cGRhdGVkIHdoZW4gaXQncyBjYWxsZWQsIG90aGVyd2lzZSB0aGUgY2hhbmdlIGlzIGRyb3BwZWQuXG4gICAqL1xuICBvblN0YXRlQ2hhbmdlOiAoc3RhdGU6IHsgb3BlbjogYm9vbGVhbiB9KSA9PiB2b2lkO1xuICAvKipcbiAgICogV2hldGhlciBgRkFCYCBpcyBjdXJyZW50bHkgdmlzaWJsZS5cbiAgICovXG4gIHZpc2libGU6IGJvb2xlYW47XG4gIC8qKlxuICAgKiBTdHlsZSBmb3IgdGhlIGdyb3VwLiBZb3UgY2FuIHVzZSBpdCB0byBwYXNzIGFkZGl0aW9uYWwgc3R5bGVzIGlmIHlvdSBuZWVkLlxuICAgKiBGb3IgZXhhbXBsZSwgeW91IGNhbiBzZXQgYW4gYWRkaXRpb25hbCBwYWRkaW5nIGlmIHlvdSBoYXZlIGEgdGFiIGJhciBhdCB0aGUgYm90dG9tLlxuICAgKi9cbiAgc3R5bGU/OiBTdHlsZVByb3A8Vmlld1N0eWxlPjtcbiAgLyoqXG4gICAqIFN0eWxlIGZvciB0aGUgRkFCLiBJdCBhbGxvd3MgdG8gcGFzcyB0aGUgRkFCIGJ1dHRvbiBzdHlsZXMsIHN1Y2ggYXMgYmFja2dyb3VuZENvbG9yLlxuICAgKi9cbiAgZmFiU3R5bGU/OiBTdHlsZVByb3A8Vmlld1N0eWxlPjtcbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKi9cbiAgdGhlbWU6IFJlYWN0TmF0aXZlUGFwZXIuVGhlbWU7XG4gIC8qKlxuICAgKiBQYXNzIGRvd24gdGVzdElEIGZyb20gR3JvdXAgcHJvcHMgdG8gRkFCLlxuICAgKi9cbiAgdGVzdElEPzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBBIGNvbXBvbmVudCB0byBkaXNwbGF5IGEgc3RhY2sgb2YgRkFCcyB3aXRoIHJlbGF0ZWQgYWN0aW9ucyBpbiBhIHNwZWVkIGRpYWwuXG4gKiBUbyByZW5kZXIgdGhlIGdyb3VwIGFib3ZlIG90aGVyIGNvbXBvbmVudHMsIHlvdSdsbCBuZWVkIHRvIHdyYXAgaXQgd2l0aCB0aGUgW2BQb3J0YWxgXShwb3J0YWwuaHRtbCkgY29tcG9uZW50LlxuICpcbiAqIDxkaXYgY2xhc3M9XCJzY3JlZW5zaG90c1wiPlxuICogICA8aW1nIHNyYz1cInNjcmVlbnNob3RzL2ZhYi1ncm91cC5wbmdcIiAvPlxuICogPC9kaXY+XG4gKlxuICogIyMgVXNhZ2VcbiAqIGBgYGpzXG4gKiBpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG4gKiBpbXBvcnQgeyBGQUIsIFBvcnRhbCwgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1uYXRpdmUtcGFwZXInO1xuICpcbiAqIGNvbnN0IE15Q29tcG9uZW50ID0gKCkgPT4ge1xuICogICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IFJlYWN0LnVzZVN0YXRlKHsgb3BlbjogZmFsc2UgfSk7XG4gKlxuICogICBjb25zdCBvblN0YXRlQ2hhbmdlID0gKHsgb3BlbiB9KSA9PiBzZXRTdGF0ZSh7IG9wZW4gfSk7XG4gKlxuICogICBjb25zdCB7IG9wZW4gfSA9IHN0YXRlO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8UHJvdmlkZXI+XG4gKiAgICAgICA8UG9ydGFsPlxuICogICAgICAgICA8RkFCLkdyb3VwXG4gKiAgICAgICAgICAgb3Blbj17b3Blbn1cbiAqICAgICAgICAgICBpY29uPXtvcGVuID8gJ2NhbGVuZGFyLXRvZGF5JyA6ICdwbHVzJ31cbiAqICAgICAgICAgICBhY3Rpb25zPXtbXG4gKiAgICAgICAgICAgICB7IGljb246ICdwbHVzJywgb25QcmVzczogKCkgPT4gY29uc29sZS5sb2coJ1ByZXNzZWQgYWRkJykgfSxcbiAqICAgICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICAgaWNvbjogJ3N0YXInLFxuICogICAgICAgICAgICAgICBsYWJlbDogJ1N0YXInLFxuICogICAgICAgICAgICAgICBvblByZXNzOiAoKSA9PiBjb25zb2xlLmxvZygnUHJlc3NlZCBzdGFyJyksXG4gKiAgICAgICAgICAgICB9LFxuICogICAgICAgICAgICAge1xuICogICAgICAgICAgICAgICBpY29uOiAnZW1haWwnLFxuICogICAgICAgICAgICAgICBsYWJlbDogJ0VtYWlsJyxcbiAqICAgICAgICAgICAgICAgb25QcmVzczogKCkgPT4gY29uc29sZS5sb2coJ1ByZXNzZWQgZW1haWwnKSxcbiAqICAgICAgICAgICAgIH0sXG4gKiAgICAgICAgICAgICB7XG4gKiAgICAgICAgICAgICAgIGljb246ICdiZWxsJyxcbiAqICAgICAgICAgICAgICAgbGFiZWw6ICdSZW1pbmQnLFxuICogICAgICAgICAgICAgICBvblByZXNzOiAoKSA9PiBjb25zb2xlLmxvZygnUHJlc3NlZCBub3RpZmljYXRpb25zJyksXG4gKiAgICAgICAgICAgICAgIHNtYWxsOiBmYWxzZSxcbiAqICAgICAgICAgICAgIH0sXG4gKiAgICAgICAgICAgXX1cbiAqICAgICAgICAgICBvblN0YXRlQ2hhbmdlPXtvblN0YXRlQ2hhbmdlfVxuICogICAgICAgICAgIG9uUHJlc3M9eygpID0+IHtcbiAqICAgICAgICAgICAgIGlmIChvcGVuKSB7XG4gKiAgICAgICAgICAgICAgIC8vIGRvIHNvbWV0aGluZyBpZiB0aGUgc3BlZWQgZGlhbCBpcyBvcGVuXG4gKiAgICAgICAgICAgICB9XG4gKiAgICAgICAgICAgfX1cbiAqICAgICAgICAgLz5cbiAqICAgICAgIDwvUG9ydGFsPlxuICogICAgIDwvUHJvdmlkZXI+XG4gKiAgICk7XG4gKiB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IE15Q29tcG9uZW50O1xuICogYGBgXG4gKi9cbmNvbnN0IEZBQkdyb3VwID0gKHtcbiAgYWN0aW9ucyxcbiAgaWNvbixcbiAgb3BlbixcbiAgb25QcmVzcyxcbiAgYWNjZXNzaWJpbGl0eUxhYmVsLFxuICB0aGVtZSxcbiAgc3R5bGUsXG4gIGZhYlN0eWxlLFxuICB2aXNpYmxlLFxuICB0ZXN0SUQsXG4gIG9uU3RhdGVDaGFuZ2UsXG4gIGNvbG9yOiBjb2xvclByb3AsXG59OiBQcm9wcykgPT4ge1xuICBjb25zdCB7IGN1cnJlbnQ6IGJhY2tkcm9wIH0gPSBSZWFjdC51c2VSZWY8QW5pbWF0ZWQuVmFsdWU+KFxuICAgIG5ldyBBbmltYXRlZC5WYWx1ZSgwKVxuICApO1xuICBjb25zdCBhbmltYXRpb25zID0gUmVhY3QudXNlUmVmPEFuaW1hdGVkLlZhbHVlW10+KFxuICAgIGFjdGlvbnMubWFwKCgpID0+IG5ldyBBbmltYXRlZC5WYWx1ZShvcGVuID8gMSA6IDApKVxuICApO1xuXG4gIGNvbnN0IFtwcmV2QWN0aW9ucywgc2V0UHJldkFjdGlvbnNdID0gUmVhY3QudXNlU3RhdGU8XG4gICAgfCB7XG4gICAgICAgIGljb246IEljb25Tb3VyY2U7XG4gICAgICAgIGxhYmVsPzogc3RyaW5nO1xuICAgICAgICBjb2xvcj86IHN0cmluZztcbiAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPzogc3RyaW5nO1xuICAgICAgICBzdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICAgICAgICBvblByZXNzOiAoKSA9PiB2b2lkO1xuICAgICAgICB0ZXN0SUQ/OiBzdHJpbmc7XG4gICAgICB9W11cbiAgICB8IG51bGxcbiAgPihudWxsKTtcblxuICBjb25zdCB7IHNjYWxlIH0gPSB0aGVtZS5hbmltYXRpb247XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAob3Blbikge1xuICAgICAgQW5pbWF0ZWQucGFyYWxsZWwoW1xuICAgICAgICBBbmltYXRlZC50aW1pbmcoYmFja2Ryb3AsIHtcbiAgICAgICAgICB0b1ZhbHVlOiAxLFxuICAgICAgICAgIGR1cmF0aW9uOiAyNTAgKiBzY2FsZSxcbiAgICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBBbmltYXRlZC5zdGFnZ2VyKFxuICAgICAgICAgIDUwICogc2NhbGUsXG4gICAgICAgICAgYW5pbWF0aW9ucy5jdXJyZW50XG4gICAgICAgICAgICAubWFwKChhbmltYXRpb24pID0+XG4gICAgICAgICAgICAgIEFuaW1hdGVkLnRpbWluZyhhbmltYXRpb24sIHtcbiAgICAgICAgICAgICAgICB0b1ZhbHVlOiAxLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxNTAgKiBzY2FsZSxcbiAgICAgICAgICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgICksXG4gICAgICBdKS5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBBbmltYXRlZC5wYXJhbGxlbChbXG4gICAgICAgIEFuaW1hdGVkLnRpbWluZyhiYWNrZHJvcCwge1xuICAgICAgICAgIHRvVmFsdWU6IDAsXG4gICAgICAgICAgZHVyYXRpb246IDIwMCAqIHNjYWxlLFxuICAgICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICAgIC4uLmFuaW1hdGlvbnMuY3VycmVudC5tYXAoKGFuaW1hdGlvbikgPT5cbiAgICAgICAgICBBbmltYXRlZC50aW1pbmcoYW5pbWF0aW9uLCB7XG4gICAgICAgICAgICB0b1ZhbHVlOiAwLFxuICAgICAgICAgICAgZHVyYXRpb246IDE1MCAqIHNjYWxlLFxuICAgICAgICAgICAgdXNlTmF0aXZlRHJpdmVyOiB0cnVlLFxuICAgICAgICAgIH0pXG4gICAgICAgICksXG4gICAgICBdKS5zdGFydCgpO1xuICAgIH1cbiAgfSwgW29wZW4sIGFjdGlvbnMsIGJhY2tkcm9wLCBzY2FsZV0pO1xuXG4gIGNvbnN0IGNsb3NlID0gKCkgPT4gb25TdGF0ZUNoYW5nZSh7IG9wZW46IGZhbHNlIH0pO1xuXG4gIGNvbnN0IHRvZ2dsZSA9ICgpID0+IG9uU3RhdGVDaGFuZ2UoeyBvcGVuOiAhb3BlbiB9KTtcblxuICBjb25zdCB7IGNvbG9ycyB9ID0gdGhlbWU7XG5cbiAgY29uc3QgbGFiZWxDb2xvciA9IHRoZW1lLmRhcmtcbiAgICA/IGNvbG9ycy50ZXh0XG4gICAgOiBjb2xvcihjb2xvcnMudGV4dCkuZmFkZSgwLjU0KS5yZ2IoKS5zdHJpbmcoKTtcbiAgY29uc3QgYmFja2Ryb3BPcGFjaXR5ID0gb3BlblxuICAgID8gYmFja2Ryb3AuaW50ZXJwb2xhdGUoe1xuICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMC41LCAxXSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxLCAxXSxcbiAgICAgIH0pXG4gICAgOiBiYWNrZHJvcDtcblxuICBjb25zdCBvcGFjaXRpZXMgPSBhbmltYXRpb25zLmN1cnJlbnQ7XG4gIGNvbnN0IHNjYWxlcyA9IG9wYWNpdGllcy5tYXAoKG9wYWNpdHkpID0+XG4gICAgb3BlblxuICAgICAgPyBvcGFjaXR5LmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLjgsIDFdLFxuICAgICAgICB9KVxuICAgICAgOiAxXG4gICk7XG5cbiAgaWYgKGFjdGlvbnMubGVuZ3RoICE9PSBwcmV2QWN0aW9ucz8ubGVuZ3RoKSB7XG4gICAgYW5pbWF0aW9ucy5jdXJyZW50ID0gYWN0aW9ucy5tYXAoXG4gICAgICAoXywgaSkgPT4gYW5pbWF0aW9ucy5jdXJyZW50W2ldIHx8IG5ldyBBbmltYXRlZC5WYWx1ZShvcGVuID8gMSA6IDApXG4gICAgKTtcbiAgICBzZXRQcmV2QWN0aW9ucyhhY3Rpb25zKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPFZpZXcgcG9pbnRlckV2ZW50cz1cImJveC1ub25lXCIgc3R5bGU9e1tzdHlsZXMuY29udGFpbmVyLCBzdHlsZV19PlxuICAgICAgPFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayBvblByZXNzPXtjbG9zZX0+XG4gICAgICAgIDxBbmltYXRlZC5WaWV3XG4gICAgICAgICAgcG9pbnRlckV2ZW50cz17b3BlbiA/ICdhdXRvJyA6ICdub25lJ31cbiAgICAgICAgICBzdHlsZT17W1xuICAgICAgICAgICAgc3R5bGVzLmJhY2tkcm9wLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBvcGFjaXR5OiBiYWNrZHJvcE9wYWNpdHksXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY29sb3JzLmJhY2tkcm9wLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdfVxuICAgICAgICAvPlxuICAgICAgPC9Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2s+XG4gICAgICA8U2FmZUFyZWFWaWV3IHBvaW50ZXJFdmVudHM9XCJib3gtbm9uZVwiIHN0eWxlPXtzdHlsZXMuc2FmZUFyZWF9PlxuICAgICAgICA8VmlldyBwb2ludGVyRXZlbnRzPXtvcGVuID8gJ2JveC1ub25lJyA6ICdub25lJ30+XG4gICAgICAgICAge2FjdGlvbnMubWFwKChpdCwgaSkgPT4gKFxuICAgICAgICAgICAgPFZpZXdcbiAgICAgICAgICAgICAga2V5PXtpfSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlYWN0L25vLWFycmF5LWluZGV4LWtleVxuICAgICAgICAgICAgICBzdHlsZT17W1xuICAgICAgICAgICAgICAgIHN0eWxlcy5pdGVtLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIG1hcmdpbkhvcml6b250YWw6XG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBpdC5zbWFsbCA9PT0gJ3VuZGVmaW5lZCcgfHwgaXQuc21hbGwgPyAyNCA6IDE2LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgIHBvaW50ZXJFdmVudHM9e29wZW4gPyAnYm94LW5vbmUnIDogJ25vbmUnfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXQubGFiZWwgJiYgKFxuICAgICAgICAgICAgICAgIDxWaWV3PlxuICAgICAgICAgICAgICAgICAgPENhcmRcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e1xuICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlcy5sYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBbeyBzY2FsZTogc2NhbGVzW2ldIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBvcGFjaXRpZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIF0gYXMgU3R5bGVQcm9wPFZpZXdTdHlsZT5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvblByZXNzPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgaXQub25QcmVzcygpO1xuICAgICAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17XG4gICAgICAgICAgICAgICAgICAgICAgaXQuYWNjZXNzaWJpbGl0eUxhYmVsICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgPyBpdC5hY2Nlc3NpYmlsaXR5TGFiZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIDogaXQubGFiZWxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFdlIGtlZXAgb2xkIGExMXkgcHJvcHMgZm9yIGJhY2t3YXJkcyBjb21wYXQgd2l0aCBvbGQgUk4gdmVyc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVRyYWl0cz1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVJvbGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VGV4dCBzdHlsZT17eyBjb2xvcjogbGFiZWxDb2xvciB9fT57aXQubGFiZWx9PC9UZXh0PlxuICAgICAgICAgICAgICAgICAgPC9DYXJkPlxuICAgICAgICAgICAgICAgIDwvVmlldz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPEZBQlxuICAgICAgICAgICAgICAgIHNtYWxsPXt0eXBlb2YgaXQuc21hbGwgIT09ICd1bmRlZmluZWQnID8gaXQuc21hbGwgOiB0cnVlfVxuICAgICAgICAgICAgICAgIGljb249e2l0Lmljb259XG4gICAgICAgICAgICAgICAgY29sb3I9e2l0LmNvbG9yfVxuICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogW3sgc2NhbGU6IHNjYWxlc1tpXSB9XSxcbiAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBvcGFjaXRpZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5jb2xvcnMuc3VyZmFjZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaXQuc3R5bGUsXG4gICAgICAgICAgICAgICAgICBdIGFzIFN0eWxlUHJvcDxWaWV3U3R5bGU+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9uUHJlc3M9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgIGl0Lm9uUHJlc3MoKTtcbiAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5TGFiZWw9e1xuICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0LmFjY2Vzc2liaWxpdHlMYWJlbCAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgICAgICAgICAgPyBpdC5hY2Nlc3NpYmlsaXR5TGFiZWxcbiAgICAgICAgICAgICAgICAgICAgOiBpdC5sYWJlbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFdlIGtlZXAgb2xkIGExMXkgcHJvcHMgZm9yIGJhY2t3YXJkcyBjb21wYXQgd2l0aCBvbGQgUk4gdmVyc2lvbnNcbiAgICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5VHJhaXRzPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5Q29tcG9uZW50VHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVJvbGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgIHRlc3RJRD17aXQudGVzdElEfVxuICAgICAgICAgICAgICAgIHZpc2libGU9e29wZW59XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvVmlldz5cbiAgICAgICAgPEZBQlxuICAgICAgICAgIG9uUHJlc3M9eygpID0+IHtcbiAgICAgICAgICAgIG9uUHJlc3M/LigpO1xuICAgICAgICAgICAgdG9nZ2xlKCk7XG4gICAgICAgICAgfX1cbiAgICAgICAgICBpY29uPXtpY29ufVxuICAgICAgICAgIGNvbG9yPXtjb2xvclByb3B9XG4gICAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXthY2Nlc3NpYmlsaXR5TGFiZWx9XG4gICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBXZSBrZWVwIG9sZCBhMTF5IHByb3BzIGZvciBiYWNrd2FyZHMgY29tcGF0IHdpdGggb2xkIFJOIHZlcnNpb25zXG4gICAgICAgICAgYWNjZXNzaWJpbGl0eVRyYWl0cz1cImJ1dHRvblwiXG4gICAgICAgICAgYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGU9XCJidXR0b25cIlxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICBhY2Nlc3NpYmlsaXR5U3RhdGU9e3sgZXhwYW5kZWQ6IG9wZW4gfX1cbiAgICAgICAgICBzdHlsZT17W3N0eWxlcy5mYWIsIGZhYlN0eWxlXX1cbiAgICAgICAgICB2aXNpYmxlPXt2aXNpYmxlfVxuICAgICAgICAgIHRlc3RJRD17dGVzdElEfVxuICAgICAgICAvPlxuICAgICAgPC9TYWZlQXJlYVZpZXc+XG4gICAgPC9WaWV3PlxuICApO1xufTtcblxuRkFCR3JvdXAuZGlzcGxheU5hbWUgPSAnRkFCLkdyb3VwJztcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKEZBQkdyb3VwKTtcblxuLy8gQGNvbXBvbmVudC1kb2NzIGlnbm9yZS1uZXh0LWxpbmVcbmNvbnN0IEZBQkdyb3VwV2l0aFRoZW1lID0gd2l0aFRoZW1lKEZBQkdyb3VwKTtcbi8vIEBjb21wb25lbnQtZG9jcyBpZ25vcmUtbmV4dC1saW5lXG5leHBvcnQgeyBGQUJHcm91cFdpdGhUaGVtZSBhcyBGQUJHcm91cCB9O1xuXG5jb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7XG4gIHNhZmVBcmVhOiB7XG4gICAgYWxpZ25JdGVtczogJ2ZsZXgtZW5kJyxcbiAgfSxcbiAgY29udGFpbmVyOiB7XG4gICAgLi4uU3R5bGVTaGVldC5hYnNvbHV0ZUZpbGxPYmplY3QsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LWVuZCcsXG4gIH0sXG4gIGZhYjoge1xuICAgIG1hcmdpbkhvcml6b250YWw6IDE2LFxuICAgIG1hcmdpbkJvdHRvbTogMTYsXG4gICAgbWFyZ2luVG9wOiAwLFxuICB9LFxuICBiYWNrZHJvcDoge1xuICAgIC4uLlN0eWxlU2hlZXQuYWJzb2x1dGVGaWxsT2JqZWN0LFxuICB9LFxuICBsYWJlbDoge1xuICAgIGJvcmRlclJhZGl1czogNSxcbiAgICBwYWRkaW5nSG9yaXpvbnRhbDogMTIsXG4gICAgcGFkZGluZ1ZlcnRpY2FsOiA2LFxuICAgIG1hcmdpblZlcnRpY2FsOiA4LFxuICAgIG1hcmdpbkhvcml6b250YWw6IDE2LFxuICAgIGVsZXZhdGlvbjogMixcbiAgfSxcbiAgaXRlbToge1xuICAgIG1hcmdpbkJvdHRvbTogMTYsXG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LWVuZCcsXG4gICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gIH0sXG59KTtcbiJdfQ==