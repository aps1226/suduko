2d2912e569b0a55fa5f093eb99952125
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.shuffle = shuffle;
exports.isValid = isValid;
exports.generateBoard = generateBoard;
exports.isValidSudoku = isValidSudoku;
exports.isSolvable = isSolvable;
exports.initBoard = initBoard;
exports.isCompleted = isCompleted;

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

function shuffle(array) {
  var currentIndex = array.length,
      randomIndex;

  while (0 !== currentIndex) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    var _ref = [array[randomIndex], array[currentIndex]];
    array[currentIndex] = _ref[0];
    array[randomIndex] = _ref[1];
  }

  return array;
}

function isValid(board, row, col, k) {
  for (var i = 0; i < 9; i++) {
    var m = 3 * Math.floor(row / 3) + Math.floor(i / 3);
    var n = 3 * Math.floor(col / 3) + i % 3;

    if (board[row][i] == k || board[i][col] == k || board[m][n] == k) {
      return false;
    }
  }

  return true;
}

function generateBoard(data) {
  for (var i = 0; i < 9; i++) {
    for (var j = 0; j < 9; j++) {
      if (data[i][j] === null) {
        for (var k = 1; k <= 9; k++) {
          if (isValid(data, i, j, k)) {
            data[i][j] = k;

            if (!generateBoard(data).some(function (row) {
              return row.includes(null);
            })) {
              return generateBoard(data);
            } else {
              data[i][j] = null;
            }
          }
        }

        return data;
      }
    }
  }

  return data;
}

function isValidSudoku(board) {
  for (var i = 0; i < 9; i++) {
    var row = new Set(),
        col = new Set(),
        box = new Set();

    for (var j = 0; j < 9; j++) {
      var _row = board[i][j];
      var _col = board[j][i];
      var _box = board[3 * Math.floor(i / 3) + Math.floor(j / 3)][3 * (i % 3) + j % 3];

      if (_row !== null) {
        if (row.has(_row)) return false;
        row.add(_row);
      }

      if (_col !== null) {
        if (col.has(_col)) return false;
        col.add(_col);
      }

      if (_box !== null) {
        if (box.has(_box)) return false;
        box.add(_box);
      }
    }
  }

  return true;
}

;

function isSolvable(data) {
  for (var i = 0; i < 9; i++) {
    for (var j = 0; j < 9; j++) {
      if (data[i][j] == null) {
        for (var k = 1; k <= 9; k++) {
          if (isValid(data, i, j, k)) {
            data[i][j] = k;

            if (isSolvable(data)) {
              return true;
            } else {
              data[i][j] = null;
            }
          }
        }

        return false;
      }
    }
  }

  return true;
}

function initBoard(curBoard, difficulty) {
  var blank;

  switch (difficulty) {
    case 0:
      blank = 81 - (37 + Math.floor(37 * Math.random()));
      break;

    case 1:
      blank = 81 - (27 + Math.floor(9 * Math.random()));
      break;

    case 2:
      blank = 81 - (19 + Math.floor(9 * Math.random()));
      break;

    case 3:
      blank = 63;
      break;

    default:
      blank = Math.floor(37 * Math.random());
  }

  for (var i = 0; i < blank; i++) {
    var row = Math.floor(9 * Math.random());
    var col = Math.floor(9 * Math.random());

    while (!curBoard[row][col]) {
      row = Math.floor(9 * Math.random()), col = Math.floor(9 * Math.random());
    }

    var clonedBoard = curBoard.map(function (arr) {
      return (0, _toConsumableArray2.default)(arr);
    });

    while (!isSolvable(clonedBoard)) {
      clonedBoard[row][col] = curBoard[row][col];
      row = Math.floor(9 * Math.random());
      col = Math.floor(9 * Math.random());

      while (!curBoard[row][col]) {
        row = Math.floor(9 * Math.random()), col = Math.floor(9 * Math.random());
      }

      clonedBoard[row][col] = null;
    }

    curBoard[row][col] = null;
  }

  return curBoard;
}

function isCompleted(board) {
  for (var i = 0; i < board.length; i++) {
    if (board[i].includes(null)) return false;
  }

  return true;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXNoZWVcXERvY3VtZW50c1xcSmF2YXNjcmlwdFxcUmVhY3RcXFJlYWN0IE5hdGl2ZVxcc3VkdWtvXFxzcmNcXHN0YXRlXFxib2FyZENvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQ00sU0FBVSxPQUFWLENBQWtCLEtBQWxCLEVBQWlDO0FBQ3JDLE1BQUksWUFBWSxHQUFVLEtBQUssQ0FBQyxNQUFoQztBQUFBLE1BQXlDLFdBQXpDOztBQUVBLFNBQU8sTUFBTSxZQUFiLEVBQTJCO0FBRXpCLElBQUEsV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsSUFBSSxDQUFDLE1BQUwsS0FBZ0IsWUFBM0IsQ0FBZDtBQUNBLElBQUEsWUFBWTtBQUhhLGVBS21CLENBQzFDLEtBQUssQ0FBQyxXQUFELENBRHFDLEVBQ3RCLEtBQUssQ0FBQyxZQUFELENBRGlCLENBTG5CO0FBS3hCLElBQUEsS0FBSyxDQUFDLFlBQUQsQ0FMbUI7QUFLSCxJQUFBLEtBQUssQ0FBQyxXQUFELENBTEY7QUFPMUI7O0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBR0ssU0FBVSxPQUFWLENBQWtCLEtBQWxCLEVBQTJDLEdBQTNDLEVBQXVELEdBQXZELEVBQW1FLENBQW5FLEVBQTJFO0FBTS9FLE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBYixFQUFnQixDQUFDLEdBQUcsQ0FBcEIsRUFBdUIsQ0FBQyxFQUF4QixFQUE0QjtBQUN4QixRQUFNLENBQUMsR0FBRyxJQUFJLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBRyxHQUFHLENBQWpCLENBQUosR0FBMEIsSUFBSSxDQUFDLEtBQUwsQ0FBVyxDQUFDLEdBQUcsQ0FBZixDQUFwQztBQUNBLFFBQU0sQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUwsQ0FBVyxHQUFHLEdBQUcsQ0FBakIsQ0FBSixHQUEwQixDQUFDLEdBQUcsQ0FBeEM7O0FBQ0EsUUFBSSxLQUFLLENBQUMsR0FB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LEVBQStCO0FBQzdCLE1BQUEsV0FBVyxDQUFDLEdBQUQsQ0FBWCxDQUFpQixHQUFqQixJQUF3QixRQUFRLENBQUMsR0FBRCxDQUFSLENBQWMsR0FBZCxDQUF4QjtBQUNBLE1BQUEsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsSUFBRSxJQUFJLENBQUMsTUFBTCxFQUFiLENBQU47QUFDQSxNQUFBLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBTCxDQUFXLElBQUUsSUFBSSxDQUFDLE1BQUwsRUFBYixDQUFOOztBQUNBLGFBQU0sQ0FBQyxRQUFRLENBQUMsR0FBRCxDQUFSLENBQWMsR0FBZCxDQUFQO0FBQTJCLFFBQUEsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsSUFBRSxJQUFJLENBQUMsTUFBTCxFQUFiLENBQU4sRUFBa0MsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsSUFBRSxJQUFJLENBQUMsTUFBTCxFQUFiLENBQXhDO0FBQTNCOztBQUNBLE1BQUEsV0FBVyxDQUFDLEdBQUQsQ0FBWCxDQUFpQixHQUFqQixJQUF3QixJQUF4QjtBQUNEOztBQUNELElBQUEsUUFBUSxDQUFDLEdBQUQsQ0FBUixDQUFjLEdBQWQsSUFBcUIsSUFBckI7QUFDRDs7QUFDRCxTQUFPLFFBQVA7QUFDRDs7QUFHSyxTQUFVLFdBQVYsQ0FBc0IsS0FBdEIsRUFBNkM7QUFDakQsT0FBSSxJQUFJLENBQUMsR0FBRyxDQUFaLEVBQWUsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUF6QixFQUFpQyxDQUFDLEVBQWxDLEVBQXFDO0FBQ25DLFFBQUcsS0FBSyxDQUFDLENBQUQsQ0FBTCxDQUFTLFFBQVQsQ0FBa0IsSUFBbEIsQ0FBSCxFQUE0QixPQUFPLEtBQVA7QUFDN0I7O0FBQ0QsU0FBTyxJQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvL0Z1bmN0aW9uIHNodWZmbGVzIGFycmF5LlxyXG5leHBvcnQgZnVuY3Rpb24gc2h1ZmZsZShhcnJheTogbnVtYmVyW10pOm51bWJlcltdIHtcclxuICB2YXIgY3VycmVudEluZGV4Om51bWJlciA9IGFycmF5Lmxlbmd0aCwgIHJhbmRvbUluZGV4Om51bWJlcjtcclxuICAvLyBXaGlsZSB0aGVyZSByZW1haW4gZWxlbWVudHMgdG8gc2h1ZmZsZS4uLlxyXG4gIHdoaWxlICgwICE9PSBjdXJyZW50SW5kZXgpIHtcclxuICAgIC8vIFBpY2sgYSByZW1haW5pbmcgZWxlbWVudC4uLlxyXG4gICAgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjdXJyZW50SW5kZXgpO1xyXG4gICAgY3VycmVudEluZGV4LS07XHJcbiAgICAvLyBBbmQgc3dhcCBpdCB3aXRoIHRoZSBjdXJyZW50IGVsZW1lbnQuXHJcbiAgICBbYXJyYXlbY3VycmVudEluZGV4XSwgYXJyYXlbcmFuZG9tSW5kZXhdXSA9IFtcclxuICAgICAgYXJyYXlbcmFuZG9tSW5kZXhdLCBhcnJheVtjdXJyZW50SW5kZXhdXTtcclxuICB9XHJcbiAgcmV0dXJuIGFycmF5O1xyXG59XHJcblxyXG4vL0hlbHBlciBmdW5jdGlvbiBmb3IgZ2VuZXJhdGVCb2FyZCBmdW5jdGlvbiB0byBkZXRlcm1pbmUgaWYgcmVzcGVjdGl2ZSByb3cgYW5kIGNvbHVtbiBhcmUgdmFsaWQgaW5wdXRzLlxyXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZChib2FyZDoobnVtYmVyfG51bGwpW11bXSwgcm93Om51bWJlciwgY29sOm51bWJlciwgazpudW1iZXIpIHtcclxuICAvL0RldGVybWluZSBpZiB0aGUgY3VycmVudCB2YWx1ZSBrIGV4aXN0cyB3aXRoIGluIHRoZSByZXNwZWN0aXZlIHBvc2l0aW9uczpcclxuICAgIC8vcm93XHJcbiAgICAvL2NvbHVtblxyXG4gICAgLy9zdWItYm94XHJcbiAgLy9JZiBpdCBkb2VzLCB0aGUgZW50cnkgaXMgbm90IHZhbGlkLlxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IG0gPSAzICogTWF0aC5mbG9vcihyb3cgLyAzKSArIE1hdGguZmxvb3IoaSAvIDMpO1xyXG4gICAgICBjb25zdCBuID0gMyAqIE1hdGguZmxvb3IoY29sIC8gMykgKyBpICUgMztcclxuICAgICAgaWYgKGJvYXJkW3Jvd11baV0gPT0gayB8fCBib2FyZFtpXVtjb2xdID09IGsgfHwgYm9hcmRbbV1bbl0gPT0gaykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gIH1cclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLy9GdW5jdGlvbiB0byBnZW5lcmF0ZSBnYW1lIGJvYXJkLlxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVCb2FyZChkYXRhOihudW1iZXJ8bnVsbClbXVtdKToobnVtYmVyfG51bGwpW11bXSB7XHJcbiAgLy9JdGVyYXRlIHRocm91Z2ggZWFjaCByb3cgb2YgYm9hcmQuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHtcclxuICAgIC8vSXRlcmF0ZSB0aHJvdWdoIGNvbHVtbiBvZiByZXNwZWN0aXZlIHJvdy5cclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgOTsgaisrKSB7XHJcbiAgICAgIC8vSWYgY3VycmVudCB2YWx1ZSBuZWVkcyBhbiBlbnRyeS5cclxuICAgICAgaWYgKGRhdGFbaV1bal0gPT09IG51bGwpIHtcclxuICAgICAgICAvL0l0ZXJhdGUgdGhyb3VnaCBwb3NzaWJsZSB2YWx1ZXMuXHJcbiAgICAgICAgZm9yIChsZXQgayA9IDE7IGsgPD0gOTsgaysrKSB7XHJcbiAgICAgICAgICAvL0RldGVybWluZSBpZiBjdXJyZW50IHZhbHVlIGlmIHZhbGlkIGZvciB0aGUgYm9hcmRcclxuICAgICAgICAgIC8vYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24uXHJcbiAgICAgICAgICBpZiAoaXNWYWxpZChkYXRhLCBpLCBqLCBrKSkge1xyXG4gICAgICAgICAgICBkYXRhW2ldW2pdID0gaztcclxuICAgICAgICAgICAgLy9JZiB0aGUgdmFsdWUgaXMgdmFsaWQsIHJlY3Vyc2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVcclxuICAgICAgICAgICAgLy9lbnRlcmVkIG9uIHRoZSBib2FyZC5cclxuICAgICAgICAgICAgaWYgKCFnZW5lcmF0ZUJvYXJkKGRhdGEpLnNvbWUocm93ID0+IHJvdy5pbmNsdWRlcyhudWxsKSkpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVCb2FyZChkYXRhKTtcclxuICAgICAgICAgICAgLy9JZiBmYWxzZSBpcyByZXR1cm5lZCwgaXRlcmF0ZSB0byB0aGUgbmV4dCB2YWx1ZS5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBkYXRhW2ldW2pdID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gZGF0YTtcclxufVxyXG5cclxuLy9GdW5jdGlvbiBkZXRlcm1pbmVzIGlmIHRoZSBjdXJyZW50IGdhbWUgYm9hcmQgaXMgdmFsaWQuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkU3Vkb2t1KGJvYXJkOihudW1iZXJ8bnVsbClbXVtdKTpib29sZWFuIHtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykge1xyXG4gICAgbGV0IHJvdyA9IG5ldyBTZXQoKSxcclxuICAgICAgICBjb2wgPSBuZXcgU2V0KCksXHJcbiAgICAgICAgYm94ID0gbmV3IFNldCgpO1xyXG5cclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgOTsgaisrKSB7XHJcbiAgICAgIGxldCBfcm93ID0gYm9hcmRbaV1bal07XHJcbiAgICAgIGxldCBfY29sID0gYm9hcmRbal1baV07XHJcbiAgICAgIGxldCBfYm94ID0gYm9hcmRbMypNYXRoLmZsb29yKGkvMykrTWF0aC5mbG9vcihqLzMpXVszKihpJTMpKyhqJTMpXVxyXG4gICAgICBcclxuICAgICAgaWYgKF9yb3cgIT09IG51bGwpIHtcclxuICAgICAgICBpZiAocm93Lmhhcyhfcm93KSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJvdy5hZGQoX3Jvdyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKF9jb2wgIT09IG51bGwpIHtcclxuICAgICAgICBpZiAoY29sLmhhcyhfY29sKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGNvbC5hZGQoX2NvbCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChfYm94ICE9PSBudWxsKSB7XHJcbiAgICAgICAgaWYgKGJveC5oYXMoX2JveCkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBib3guYWRkKF9ib3gpO1xyXG4gICAgICB9IFxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gdHJ1ZVxyXG59O1xyXG5cclxuLy9GdW5jdGlvbiBkZXRlcm1pbmVzIGlmIHRoZSBjdXJyZW50IGdhbWUgYm9hcmQgaXMgc29sdmFibGUuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1NvbHZhYmxlKGRhdGE6KG51bWJlcnxudWxsKVtdW10pOmJvb2xlYW4ge1xyXG4gIC8vSXRlcmF0ZSB0aHJvdWdoIGVhY2ggcm93IG9mIGJvYXJkLlxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7XHJcbiAgICAvL0l0ZXJhdGUgdGhyb3VnaCBjb2x1bW4gb2YgcmVzcGVjdGl2ZSByb3cuXHJcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDk7IGorKykge1xyXG4gICAgICAvL0lmIGN1cnJlbnQgdmFsdWUgbmVlZHMgYW4gZW50cnkuXHJcbiAgICAgIGlmIChkYXRhW2ldW2pdID09IG51bGwpIHtcclxuICAgICAgICAvL0l0ZXJhdGUgdGhyb3VnaCBwb3NzaWJsZSB2YWx1ZXMuXHJcbiAgICAgICAgZm9yIChsZXQgayA9IDE7IGsgPD0gOTsgaysrKSB7XHJcbiAgICAgICAgICAvL0RldGVybWluZSBpZiBjdXJyZW50IHZhbHVlIGlmIHZhbGlkIGZvciB0aGUgYm9hcmRcclxuICAgICAgICAgIC8vYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24uXHJcbiAgICAgICAgICBpZiAoaXNWYWxpZChkYXRhLCBpLCBqLCBrKSkge1xyXG4gICAgICAgICAgICBkYXRhW2ldW2pdID0gaztcclxuICAgICAgICAgICAgLy9JZiB0aGUgdmFsdWUgaXMgdmFsaWQsIHJlY3Vyc2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVcclxuICAgICAgICAgICAgLy9lbnRlcmVkIG9uIHRoZSBib2FyZC5cclxuICAgICAgICAgICAgaWYgKGlzU29sdmFibGUoZGF0YSkpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgLy9JZiBmYWxzZSBpcyByZXR1cm5lZCwgaXRlcmF0ZSB0byB0aGUgbmV4dCB2YWx1ZS5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBkYXRhW2ldW2pdID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8vRnVuY3Rpb24gaW5pdGlhbGl6ZXMgZ2FtZSBib2FyZCBiYXNlZCBvbiBkaWZmaWN1bHR5IGlucHV0LlxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdEJvYXJkKGN1ckJvYXJkOiAobnVtYmVyfG51bGwpW11bXSwgZGlmZmljdWx0eTpudW1iZXIpOihudW1iZXJ8bnVsbClbXVtde1xyXG4gIGxldCBibGFuazpudW1iZXI7XHJcbiAgc3dpdGNoKGRpZmZpY3VsdHkpe1xyXG4gICAgY2FzZSAwOlxyXG4gICAgICBibGFuayA9IDgxIC0gKDM3ICsgTWF0aC5mbG9vcigzNyAqIE1hdGgucmFuZG9tKCkpKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIDE6XHJcbiAgICAgIGJsYW5rID0gODEgLSAoMjcgKyBNYXRoLmZsb29yKDkgKiBNYXRoLnJhbmRvbSgpKSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAyOlxyXG4gICAgICBibGFuayA9IDgxIC0gKDE5ICsgTWF0aC5mbG9vcig5ICogTWF0aC5yYW5kb20oKSkpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMzpcclxuICAgICAgYmxhbmsgPSA2MztcclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICBibGFuayA9IE1hdGguZmxvb3IoMzcgKiBNYXRoLnJhbmRvbSgpKTtcclxuICB9XHJcblxyXG4gIGZvcihsZXQgaSA9IDA7IGkgPCBibGFuazsgaSsrKXtcclxuICAgIGxldCByb3c6bnVtYmVyID0gTWF0aC5mbG9vcig5Kk1hdGgucmFuZG9tKCkpO1xyXG4gICAgbGV0IGNvbDpudW1iZXIgPSBNYXRoLmZsb29yKDkqTWF0aC5yYW5kb20oKSk7XHJcbiAgICB3aGlsZSghY3VyQm9hcmRbcm93XVtjb2xdKSByb3cgPSBNYXRoLmZsb29yKDkqTWF0aC5yYW5kb20oKSksY29sID0gTWF0aC5mbG9vcig5Kk1hdGgucmFuZG9tKCkpO1xyXG4gICAgY29uc3QgY2xvbmVkQm9hcmQgPSBjdXJCb2FyZC5tYXAoYXJyID0+IFsuLi5hcnJdKVxyXG4gICAgd2hpbGUoIWlzU29sdmFibGUoY2xvbmVkQm9hcmQpKXtcclxuICAgICAgY2xvbmVkQm9hcmRbcm93XVtjb2xdID0gY3VyQm9hcmRbcm93XVtjb2xdO1xyXG4gICAgICByb3cgPSBNYXRoLmZsb29yKDkqTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgIGNvbCA9IE1hdGguZmxvb3IoOSpNYXRoLnJhbmRvbSgpKTtcclxuICAgICAgd2hpbGUoIWN1ckJvYXJkW3Jvd11bY29sXSkgcm93ID0gTWF0aC5mbG9vcig5Kk1hdGgucmFuZG9tKCkpLGNvbCA9IE1hdGguZmxvb3IoOSpNYXRoLnJhbmRvbSgpKTtcclxuICAgICAgY2xvbmVkQm9hcmRbcm93XVtjb2xdID0gbnVsbDtcclxuICAgIH1cclxuICAgIGN1ckJvYXJkW3Jvd11bY29sXSA9IG51bGw7XHJcbiAgfVxyXG4gIHJldHVybiBjdXJCb2FyZDtcclxufVxyXG5cclxuLy9GdW5jdGlvbiBkZXRlcm1pbmVzIGlmIHRoZSBib2FyZCBoYXMgYmVlbiBzb2x2ZWQuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0NvbXBsZXRlZChib2FyZDoobnVtYmVyfG51bGwpW11bXSk6Ym9vbGVhbntcclxuICBmb3IobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspe1xyXG4gICAgaWYoYm9hcmRbaV0uaW5jbHVkZXMobnVsbCkpIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgcmV0dXJuIHRydWU7XHJcbn0iXX0=