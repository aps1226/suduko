9ebe3e97cc00e916f9e70f9b9f2c28a9
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _Platform = _interopRequireDefault(require("../../Utilities/Platform"));

var React = _interopRequireWildcard(require("react"));

var _StyleSheet = _interopRequireDefault(require("../../StyleSheet/StyleSheet"));

var _AndroidSwitchNativeComponent = _interopRequireWildcard(require("./AndroidSwitchNativeComponent"));

var _SwitchNativeComponent = _interopRequireWildcard(require("./SwitchNativeComponent"));

var _excluded = ["disabled", "ios_backgroundColor", "onChange", "onValueChange", "style", "thumbColor", "trackColor", "value"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var Switch = function (_React$Component) {
  (0, _inherits2.default)(Switch, _React$Component);

  var _super = _createSuper(Switch);

  function Switch() {
    var _this;

    (0, _classCallCheck2.default)(this, Switch);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));

    _this._handleChange = function (event) {
      if (_this.props.onChange != null) {
        _this.props.onChange(event);
      }

      if (_this.props.onValueChange != null) {
        _this.props.onValueChange(event.nativeEvent.value);
      }

      _this._lastNativeValue = event.nativeEvent.value;

      _this.forceUpdate();
    };

    _this._handleSwitchNativeComponentRef = function (ref) {
      _this._nativeSwitchRef = ref;
    };

    return _this;
  }

  (0, _createClass2.default)(Switch, [{
    key: "render",
    value: function render() {
      var _props$accessibilityR2;

      var _this$props = this.props,
          disabled = _this$props.disabled,
          ios_backgroundColor = _this$props.ios_backgroundColor,
          onChange = _this$props.onChange,
          onValueChange = _this$props.onValueChange,
          style = _this$props.style,
          thumbColor = _this$props.thumbColor,
          trackColor = _this$props.trackColor,
          value = _this$props.value,
          props = (0, _objectWithoutProperties2.default)(_this$props, _excluded);
      var trackColorForFalse = trackColor == null ? void 0 : trackColor.false;
      var trackColorForTrue = trackColor == null ? void 0 : trackColor.true;

      if (_Platform.default.OS === 'android') {
        var _props$accessibilityR;

        var _platformProps = {
          enabled: disabled !== true,
          on: value === true,
          style: style,
          thumbTintColor: thumbColor,
          trackColorForFalse: trackColorForFalse,
          trackColorForTrue: trackColorForTrue,
          trackTintColor: value === true ? trackColorForTrue : trackColorForFalse
        };
        return React.createElement(_AndroidSwitchNativeComponent.default, (0, _extends2.default)({}, props, _platformProps, {
          accessibilityRole: (_props$accessibilityR = props.accessibilityRole) != null ? _props$accessibilityR : 'switch',
          onChange: this._handleChange,
          onResponderTerminationRequest: returnsFalse,
          onStartShouldSetResponder: returnsTrue,
          ref: this._handleSwitchNativeComponentRef
        }));
      }

      var platformProps = {
        disabled: disabled,
        onTintColor: trackColorForTrue,
        style: _StyleSheet.default.compose({
          height: 31,
          width: 51
        }, _StyleSheet.default.compose(style, ios_backgroundColor == null ? null : {
          backgroundColor: ios_backgroundColor,
          borderRadius: 16
        })),
        thumbTintColor: thumbColor,
        tintColor: trackColorForFalse,
        value: value === true
      };
      return React.createElement(_SwitchNativeComponent.default, (0, _extends2.default)({}, props, platformProps, {
        accessibilityRole: (_props$accessibilityR2 = props.accessibilityRole) != null ? _props$accessibilityR2 : 'switch',
        onChange: this._handleChange,
        onResponderTerminationRequest: returnsFalse,
        onStartShouldSetResponder: returnsTrue,
        ref: this._handleSwitchNativeComponentRef
      }));
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      var nativeProps = {};
      var value = this.props.value === true;

      if (this._lastNativeValue !== value) {
        nativeProps.value = value;
      }

      if (Object.keys(nativeProps).length > 0 && this._nativeSwitchRef && this._nativeSwitchRef.setNativeProps) {
        if (_Platform.default.OS === 'android') {
          _AndroidSwitchNativeComponent.Commands.setNativeValue(this._nativeSwitchRef, nativeProps.value);
        } else {
          _SwitchNativeComponent.Commands.setValue(this._nativeSwitchRef, nativeProps.value);
        }
      }
    }
  }]);
  return Switch;
}(React.Component);

var returnsFalse = function returnsFalse() {
  return false;
};

var returnsTrue = function returnsTrue() {
  return true;
};

module.exports = Switch;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN3aXRjaC5qcyJdLCJuYW1lcyI6WyJTd2l0Y2giLCJfaGFuZGxlQ2hhbmdlIiwiZXZlbnQiLCJwcm9wcyIsIm9uQ2hhbmdlIiwib25WYWx1ZUNoYW5nZSIsIm5hdGl2ZUV2ZW50IiwidmFsdWUiLCJfbGFzdE5hdGl2ZVZhbHVlIiwiZm9yY2VVcGRhdGUiLCJfaGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmIiwicmVmIiwiX25hdGl2ZVN3aXRjaFJlZiIsImRpc2FibGVkIiwiaW9zX2JhY2tncm91bmRDb2xvciIsInN0eWxlIiwidGh1bWJDb2xvciIsInRyYWNrQ29sb3IiLCJ0cmFja0NvbG9yRm9yRmFsc2UiLCJmYWxzZSIsInRyYWNrQ29sb3JGb3JUcnVlIiwidHJ1ZSIsIlBsYXRmb3JtIiwiT1MiLCJwbGF0Zm9ybVByb3BzIiwiZW5hYmxlZCIsIm9uIiwidGh1bWJUaW50Q29sb3IiLCJ0cmFja1RpbnRDb2xvciIsImFjY2Vzc2liaWxpdHlSb2xlIiwicmV0dXJuc0ZhbHNlIiwicmV0dXJuc1RydWUiLCJvblRpbnRDb2xvciIsIlN0eWxlU2hlZXQiLCJjb21wb3NlIiwiaGVpZ2h0Iiwid2lkdGgiLCJiYWNrZ3JvdW5kQ29sb3IiLCJib3JkZXJSYWRpdXMiLCJ0aW50Q29sb3IiLCJuYXRpdmVQcm9wcyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJzZXROYXRpdmVQcm9wcyIsIkFuZHJvaWRTd2l0Y2hDb21tYW5kcyIsInNldE5hdGl2ZVZhbHVlIiwiU3dpdGNoQ29tbWFuZHMiLCJzZXRWYWx1ZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBV0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUVBOztBQUdBOzs7Ozs7Ozs7Ozs7SUE0RU1BLE07Ozs7Ozs7Ozs7Ozs7Ozs7VUEwR0pDLGEsR0FBZ0IsVUFBQ0MsS0FBRCxFQUE4QjtBQUM1QyxVQUFJLE1BQUtDLEtBQUwsQ0FB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Ii8qKlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKiBAZm9ybWF0XG4gKiBAZ2VuZXJhdGUtZG9jc1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IFBsYXRmb3JtIGZyb20gJy4uLy4uL1V0aWxpdGllcy9QbGF0Zm9ybSc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgU3R5bGVTaGVldCBmcm9tICcuLi8uLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXQnO1xuXG5pbXBvcnQgQW5kcm9pZFN3aXRjaE5hdGl2ZUNvbXBvbmVudCwge1xuICBDb21tYW5kcyBhcyBBbmRyb2lkU3dpdGNoQ29tbWFuZHMsXG59IGZyb20gJy4vQW5kcm9pZFN3aXRjaE5hdGl2ZUNvbXBvbmVudCc7XG5pbXBvcnQgU3dpdGNoTmF0aXZlQ29tcG9uZW50LCB7XG4gIENvbW1hbmRzIGFzIFN3aXRjaENvbW1hbmRzLFxufSBmcm9tICcuL1N3aXRjaE5hdGl2ZUNvbXBvbmVudCc7XG5cbmltcG9ydCB0eXBlIHtDb2xvclZhbHVlfSBmcm9tICcuLi8uLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXRUeXBlcyc7XG5pbXBvcnQgdHlwZSB7U3ludGhldGljRXZlbnR9IGZyb20gJy4uLy4uL1R5cGVzL0NvcmVFdmVudFR5cGVzJztcbmltcG9ydCB0eXBlIHtWaWV3UHJvcHN9IGZyb20gJy4uL1ZpZXcvVmlld1Byb3BUeXBlcyc7XG5cbnR5cGUgU3dpdGNoQ2hhbmdlRXZlbnQgPSBTeW50aGV0aWNFdmVudDxcbiAgJFJlYWRPbmx5PHt8XG4gICAgdmFsdWU6IGJvb2xlYW4sXG4gIHx9Pixcbj47XG5cbmV4cG9ydCB0eXBlIFByb3BzID0gJFJlYWRPbmx5PHt8XG4gIC4uLlZpZXdQcm9wcyxcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgc3dpdGNoIGlzIGRpc2FibGVkLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICovXG4gIGRpc2FibGVkPzogP2Jvb2xlYW4sXG5cbiAgLyoqXG4gICAqIEJvb2xlYW4gdmFsdWUgb2YgdGhlIHN3aXRjaC4gRGVmYXVsdHMgdG8gZmFsc2UuXG4gICAqL1xuICB2YWx1ZT86ID9ib29sZWFuLFxuXG4gIC8qKlxuICAgKiBDdXN0b20gY29sb3IgZm9yIHRoZSBzd2l0Y2ggdGh1bWIuXG4gICAqL1xuICB0aHVtYkNvbG9yPzogP0NvbG9yVmFsdWUsXG5cbiAgLyoqXG4gICAqIEN1c3RvbSBjb2xvcnMgZm9yIHRoZSBzd2l0Y2ggdHJhY2suXG4gICAqXG4gICAqIE5PVEU6IE9uIGlPUyB3aGVuIHRoZSBzd2l0Y2ggdmFsdWUgaXMgZmFsc2UsIHRoZSB0cmFjayBzaHJpbmtzIGludG8gdGhlXG4gICAqIGJvcmRlci4gSWYgeW91IHdhbnQgdG8gY2hhbmdlIHRoZSBjb2xvciBvZiB0aGUgYmFja2dyb3VuZCBleHBvc2VkIGJ5IHRoZVxuICAgKiBzaHJ1bmtlbiB0cmFjaywgdXNlIGBpb3NfYmFja2dyb3VuZENvbG9yYC5cbiAgICovXG4gIHRyYWNrQ29sb3I/OiA/JFJlYWRPbmx5PHt8XG4gICAgZmFsc2U/OiA/Q29sb3JWYWx1ZSxcbiAgICB0cnVlPzogP0NvbG9yVmFsdWUsXG4gIHx9PixcblxuICAvKipcbiAgICogT24gaU9TLCBjdXN0b20gY29sb3IgZm9yIHRoZSBiYWNrZ3JvdW5kLiBUaGlzIGJhY2tncm91bmQgY29sb3IgY2FuIGJlIHNlZW5cbiAgICogZWl0aGVyIHdoZW4gdGhlIHN3aXRjaCB2YWx1ZSBpcyBmYWxzZSBvciB3aGVuIHRoZSBzd2l0Y2ggaXMgZGlzYWJsZWQgKGFuZFxuICAgKiB0aGUgc3dpdGNoIGlzIHRyYW5zbHVjZW50KS5cbiAgICovXG4gIGlvc19iYWNrZ3JvdW5kQ29sb3I/OiA/Q29sb3JWYWx1ZSxcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gdGhlIHVzZXIgdHJpZXMgdG8gY2hhbmdlIHRoZSB2YWx1ZSBvZiB0aGUgc3dpdGNoLlxuICAgKlxuICAgKiBSZWNlaXZlcyB0aGUgY2hhbmdlIGV2ZW50IGFzIGFuIGFyZ3VtZW50LiBJZiB5b3Ugd2FudCB0byBvbmx5IHJlY2VpdmUgdGhlXG4gICAqIG5ldyB2YWx1ZSwgdXNlIGBvblZhbHVlQ2hhbmdlYCBpbnN0ZWFkLlxuICAgKi9cbiAgb25DaGFuZ2U/OiA/KGV2ZW50OiBTd2l0Y2hDaGFuZ2VFdmVudCkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQsXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoZSB1c2VyIHRyaWVzIHRvIGNoYW5nZSB0aGUgdmFsdWUgb2YgdGhlIHN3aXRjaC5cbiAgICpcbiAgICogUmVjZWl2ZXMgdGhlIG5ldyB2YWx1ZSBhcyBhbiBhcmd1bWVudC4gSWYgeW91IHdhbnQgdG8gaW5zdGVhZCByZWNlaXZlIGFuXG4gICAqIGV2ZW50LCB1c2UgYG9uQ2hhbmdlYC5cbiAgICovXG4gIG9uVmFsdWVDaGFuZ2U/OiA/KHZhbHVlOiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCxcbnx9PjtcblxuLyoqXG4gKiBBIHZpc3VhbCB0b2dnbGUgYmV0d2VlbiB0d28gbXV0dWFsbHkgZXhjbHVzaXZlIHN0YXRlcy5cbiAqXG4gKiBUaGlzIGlzIGEgY29udHJvbGxlZCBjb21wb25lbnQgdGhhdCByZXF1aXJlcyBhbiBgb25WYWx1ZUNoYW5nZWAgY2FsbGJhY2sgdGhhdFxuICogdXBkYXRlcyB0aGUgYHZhbHVlYCBwcm9wIGluIG9yZGVyIGZvciB0aGUgY29tcG9uZW50IHRvIHJlZmxlY3QgdXNlciBhY3Rpb25zLlxuICogSWYgdGhlIGB2YWx1ZWAgcHJvcCBpcyBub3QgdXBkYXRlZCwgdGhlIGNvbXBvbmVudCB3aWxsIGNvbnRpbnVlIHRvIHJlbmRlciB0aGVcbiAqIHN1cHBsaWVkIGB2YWx1ZWAgcHJvcCBpbnN0ZWFkIG9mIHRoZSBleHBlY3RlZCByZXN1bHQgb2YgYW55IHVzZXIgYWN0aW9ucy5cbiAqL1xuY2xhc3MgU3dpdGNoIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIF9uYXRpdmVTd2l0Y2hSZWY6ID9SZWFjdC5FbGVtZW50UmVmPFxuICAgIHR5cGVvZiBTd2l0Y2hOYXRpdmVDb21wb25lbnQgfCB0eXBlb2YgQW5kcm9pZFN3aXRjaE5hdGl2ZUNvbXBvbmVudCxcbiAgPjtcbiAgX2xhc3ROYXRpdmVWYWx1ZTogP2Jvb2xlYW47XG5cbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xuICAgIGNvbnN0IHtcbiAgICAgIGRpc2FibGVkLFxuICAgICAgaW9zX2JhY2tncm91bmRDb2xvcixcbiAgICAgIG9uQ2hhbmdlLFxuICAgICAgb25WYWx1ZUNoYW5nZSxcbiAgICAgIHN0eWxlLFxuICAgICAgdGh1bWJDb2xvcixcbiAgICAgIHRyYWNrQ29sb3IsXG4gICAgICB2YWx1ZSxcbiAgICAgIC4uLnByb3BzXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBjb25zdCB0cmFja0NvbG9yRm9yRmFsc2UgPSB0cmFja0NvbG9yPy5mYWxzZTtcbiAgICBjb25zdCB0cmFja0NvbG9yRm9yVHJ1ZSA9IHRyYWNrQ29sb3I/LnRydWU7XG5cbiAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgICAgY29uc3QgcGxhdGZvcm1Qcm9wcyA9IHtcbiAgICAgICAgZW5hYmxlZDogZGlzYWJsZWQgIT09IHRydWUsXG4gICAgICAgIG9uOiB2YWx1ZSA9PT0gdHJ1ZSxcbiAgICAgICAgc3R5bGUsXG4gICAgICAgIHRodW1iVGludENvbG9yOiB0aHVtYkNvbG9yLFxuICAgICAgICB0cmFja0NvbG9yRm9yRmFsc2U6IHRyYWNrQ29sb3JGb3JGYWxzZSxcbiAgICAgICAgdHJhY2tDb2xvckZvclRydWU6IHRyYWNrQ29sb3JGb3JUcnVlLFxuICAgICAgICB0cmFja1RpbnRDb2xvcjogdmFsdWUgPT09IHRydWUgPyB0cmFja0NvbG9yRm9yVHJ1ZSA6IHRyYWNrQ29sb3JGb3JGYWxzZSxcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxBbmRyb2lkU3dpdGNoTmF0aXZlQ29tcG9uZW50XG4gICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgIHsuLi5wbGF0Zm9ybVByb3BzfVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPXtwcm9wcy5hY2Nlc3NpYmlsaXR5Um9sZSA/PyAnc3dpdGNoJ31cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5faGFuZGxlQ2hhbmdlfVxuICAgICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0PXtyZXR1cm5zRmFsc2V9XG4gICAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17cmV0dXJuc1RydWV9XG4gICAgICAgICAgcmVmPXt0aGlzLl9oYW5kbGVTd2l0Y2hOYXRpdmVDb21wb25lbnRSZWZ9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXRmb3JtUHJvcHMgPSB7XG4gICAgICBkaXNhYmxlZCxcbiAgICAgIG9uVGludENvbG9yOiB0cmFja0NvbG9yRm9yVHJ1ZSxcbiAgICAgIHN0eWxlOiBTdHlsZVNoZWV0LmNvbXBvc2UoXG4gICAgICAgIHtoZWlnaHQ6IDMxLCB3aWR0aDogNTF9LFxuICAgICAgICBTdHlsZVNoZWV0LmNvbXBvc2UoXG4gICAgICAgICAgc3R5bGUsXG4gICAgICAgICAgaW9zX2JhY2tncm91bmRDb2xvciA9PSBudWxsXG4gICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogaW9zX2JhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6IDE2LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICApLFxuICAgICAgKSxcbiAgICAgIHRodW1iVGludENvbG9yOiB0aHVtYkNvbG9yLFxuICAgICAgdGludENvbG9yOiB0cmFja0NvbG9yRm9yRmFsc2UsXG4gICAgICB2YWx1ZTogdmFsdWUgPT09IHRydWUsXG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3dpdGNoTmF0aXZlQ29tcG9uZW50XG4gICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgey4uLnBsYXRmb3JtUHJvcHN9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPXtwcm9wcy5hY2Nlc3NpYmlsaXR5Um9sZSA/PyAnc3dpdGNoJ31cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMuX2hhbmRsZUNoYW5nZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e3JldHVybnNGYWxzZX1cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17cmV0dXJuc1RydWV9XG4gICAgICAgIHJlZj17dGhpcy5faGFuZGxlU3dpdGNoTmF0aXZlQ29tcG9uZW50UmVmfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgIC8vIFRoaXMgaXMgbmVjZXNzYXJ5IGluIGNhc2UgbmF0aXZlIHVwZGF0ZXMgdGhlIHN3aXRjaCBhbmQgSlMgZGVjaWRlc1xuICAgIC8vIHRoYXQgdGhlIHVwZGF0ZSBzaG91bGQgYmUgaWdub3JlZCBhbmQgd2Ugc2hvdWxkIHN0aWNrIHdpdGggdGhlIHZhbHVlXG4gICAgLy8gdGhhdCB3ZSBoYXZlIGluIEpTLlxuICAgIGNvbnN0IG5hdGl2ZVByb3BzID0ge307XG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlID09PSB0cnVlO1xuXG4gICAgaWYgKHRoaXMuX2xhc3ROYXRpdmVWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgIG5hdGl2ZVByb3BzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgT2JqZWN0LmtleXMobmF0aXZlUHJvcHMpLmxlbmd0aCA+IDAgJiZcbiAgICAgIHRoaXMuX25hdGl2ZVN3aXRjaFJlZiAmJlxuICAgICAgdGhpcy5fbmF0aXZlU3dpdGNoUmVmLnNldE5hdGl2ZVByb3BzXG4gICAgKSB7XG4gICAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgICAgICBBbmRyb2lkU3dpdGNoQ29tbWFuZHMuc2V0TmF0aXZlVmFsdWUoXG4gICAgICAgICAgdGhpcy5fbmF0aXZlU3dpdGNoUmVmLFxuICAgICAgICAgIG5hdGl2ZVByb3BzLnZhbHVlLFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgU3dpdGNoQ29tbWFuZHMuc2V0VmFsdWUodGhpcy5fbmF0aXZlU3dpdGNoUmVmLCBuYXRpdmVQcm9wcy52YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUNoYW5nZSA9IChldmVudDogU3dpdGNoQ2hhbmdlRXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy5vbkNoYW5nZSAhPSBudWxsKSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKGV2ZW50KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wcm9wcy5vblZhbHVlQ2hhbmdlICE9IG51bGwpIHtcbiAgICAgIHRoaXMucHJvcHMub25WYWx1ZUNoYW5nZShldmVudC5uYXRpdmVFdmVudC52YWx1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy5fbGFzdE5hdGl2ZVZhbHVlID0gZXZlbnQubmF0aXZlRXZlbnQudmFsdWU7XG4gICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICB9O1xuXG4gIF9oYW5kbGVTd2l0Y2hOYXRpdmVDb21wb25lbnRSZWYgPSAoXG4gICAgcmVmOiA/UmVhY3QuRWxlbWVudFJlZjxcbiAgICAgIHR5cGVvZiBTd2l0Y2hOYXRpdmVDb21wb25lbnQgfCB0eXBlb2YgQW5kcm9pZFN3aXRjaE5hdGl2ZUNvbXBvbmVudCxcbiAgICA+LFxuICApID0+IHtcbiAgICB0aGlzLl9uYXRpdmVTd2l0Y2hSZWYgPSByZWY7XG4gIH07XG59XG5cbmNvbnN0IHJldHVybnNGYWxzZSA9ICgpID0+IGZhbHNlO1xuY29uc3QgcmV0dXJuc1RydWUgPSAoKSA9PiB0cnVlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN3aXRjaDtcbiJdfQ==