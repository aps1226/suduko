e4ced514c47a93bed7adc4034b025c11
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

var _objectWithoutProperties2 = _interopRequireDefault2(require("@babel/runtime/helpers/objectWithoutProperties"));

var _excluded = ["visible", "icon", "children", "actions", "contentStyle", "style", "theme"],
    _excluded2 = ["label"];
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _Surface = _interopRequireDefault(require("./Surface"));

var _Text = _interopRequireDefault(require("./Typography/Text"));

var _Button = _interopRequireDefault(require("./Button"));

var _Icon = _interopRequireDefault(require("./Icon"));

var _theming = require("../core/theming");

var _shadow = _interopRequireDefault(require("../styles/shadow"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

var ELEVATION = 1;
var DEFAULT_MAX_WIDTH = 960;

var Banner = function Banner(_ref) {
  var visible = _ref.visible,
      icon = _ref.icon,
      children = _ref.children,
      actions = _ref.actions,
      contentStyle = _ref.contentStyle,
      style = _ref.style,
      theme = _ref.theme,
      rest = (0, _objectWithoutProperties2.default)(_ref, _excluded);

  var _React$useRef = React.useRef(new _reactNative.Animated.Value(visible ? 1 : 0)),
      position = _React$useRef.current;

  var _React$useState = React.useState({
    height: 0,
    measured: false
  }),
      _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
      layout = _React$useState2[0],
      setLayout = _React$useState2[1];

  var scale = theme.animation.scale;
  React.useEffect(function () {
    if (visible) {
      _reactNative.Animated.timing(position, {
        duration: 250 * scale,
        toValue: 1,
        useNativeDriver: false
      }).start();
    } else {
      _reactNative.Animated.timing(position, {
        duration: 200 * scale,
        toValue: 0,
        useNativeDriver: false
      }).start();
    }
  }, [visible, position, scale]);

  var handleLayout = function handleLayout(_ref2) {
    var nativeEvent = _ref2.nativeEvent;
    var height = nativeEvent.layout.height;
    setLayout({
      height: height,
      measured: true
    });
  };

  var height = _reactNative.Animated.multiply(position, layout.height);

  var translateY = _reactNative.Animated.multiply(_reactNative.Animated.add(position, -1), layout.height);

  return React.createElement(_Surface.default, _extends({}, rest, {
    style: [styles.container, (0, _shadow.default)(ELEVATION), style]
  }), React.createElement(_reactNative.View, {
    style: [styles.wrapper, contentStyle]
  }, React.createElement(_reactNative.Animated.View, {
    style: {
      height: height
    }
  }), React.createElement(_reactNative.Animated.View, {
    onLayout: handleLayout,
    style: [layout.measured || !visible ? [styles.absolute, {
      transform: [{
        translateY: translateY
      }]
    }] : null, !layout.measured && !visible ? {
      opacity: 0
    } : null]
  }, React.createElement(_reactNative.View, {
    style: styles.content
  }, icon ? React.createElement(_reactNative.View, {
    style: styles.icon
  }, React.createElement(_Icon.default, {
    source: icon,
    size: 40
  })) : null, React.createElement(_Text.default, {
    style: styles.message
  }, children)), React.createElement(_reactNative.View, {
    style: styles.actions
  }, actions.map(function (_ref3, i) {
    var label = _ref3.label,
        others = (0, _objectWithoutProperties2.default)(_ref3, _excluded2);
    return React.createElement(_Button.default, _extends({
      key: i,
      compact: true,
      mode: "text",
      style: styles.button
    }, others), label);
  })))));
};

var styles = _reactNative.StyleSheet.create({
  container: {
    elevation: ELEVATION
  },
  wrapper: {
    overflow: 'hidden',
    alignSelf: 'center',
    width: '100%',
    maxWidth: DEFAULT_MAX_WIDTH
  },
  absolute: {
    position: 'absolute',
    top: 0,
    width: '100%'
  },
  content: {
    flexDirection: 'row',
    justifyContent: 'flex-start',
    marginHorizontal: 8,
    marginTop: 16,
    marginBottom: 0
  },
  icon: {
    margin: 8
  },
  message: {
    flex: 1,
    margin: 8
  },
  actions: {
    flexDirection: 'row',
    justifyContent: 'flex-end',
    margin: 4
  },
  button: {
    margin: 4
  }
});

var _default = (0, _theming.withTheme)(Banner);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhbm5lci50c3giXSwibmFtZXMiOlsiRUxFVkFUSU9OIiwiREVGQVVMVF9NQVhfV0lEVEgiLCJCYW5uZXIiLCJyZXN0IiwiY3VycmVudCIsInBvc2l0aW9uIiwiUmVhY3QiLCJBbmltYXRlZCIsInZpc2libGUiLCJoZWlnaHQiLCJtZWFzdXJlZCIsInNjYWxlIiwidGhlbWUiLCJkdXJhdGlvbiIsInRvVmFsdWUiLCJ1c2VOYXRpdmVEcml2ZXIiLCJoYW5kbGVMYXlvdXQiLCJuYXRpdmVFdmVudCIsInNldExheW91dCIsImxheW91dCIsInRyYW5zbGF0ZVkiLCJzdHlsZXMiLCJ0cmFuc2Zvcm0iLCJvcGFjaXR5IiwiY29udGVudCIsImljb24iLCJtZXNzYWdlIiwiYWN0aW9ucyIsIm90aGVycyIsImJ1dHRvbiIsImNvbnRhaW5lciIsImVsZXZhdGlvbiIsIndyYXBwZXIiLCJvdmVyZmxvdyIsImFsaWduU2VsZiIsIndpZHRoIiwibWF4V2lkdGgiLCJhYnNvbHV0ZSIsInRvcCIsImZsZXhEaXJlY3Rpb24iLCJqdXN0aWZ5Q29udGVudCIsIm1hcmdpbkhvcml6b250YWwiLCJtYXJnaW5Ub3AiLCJtYXJnaW5Cb3R0b20iLCJtYXJnaW4iLCJmbGV4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBLEtBQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFlBQUEsR0FBQSxPQUFBLENBQUEsY0FBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxhQUFBLENBQUE7O0FBQ0EsSUFBQSxLQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLHFCQUFBLENBQUE7O0FBQ0EsSUFBQSxPQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLFlBQUEsQ0FBQTs7QUFDQSxJQUFBLEtBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsVUFBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLE9BQUEsbUJB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QUFDUmhDLElBQUFBLFFBQVEsRUFEQSxVQUFBO0FBRVJpQyxJQUFBQSxHQUFHLEVBRkssQ0FBQTtBQUdSSCxJQUFBQSxLQUFLLEVBQUU7QUFIQyxHQVZxQjtBQWUvQlgsRUFBQUEsT0FBTyxFQUFFO0FBQ1BlLElBQUFBLGFBQWEsRUFETixLQUFBO0FBRVBDLElBQUFBLGNBQWMsRUFGUCxZQUFBO0FBR1BDLElBQUFBLGdCQUFnQixFQUhULENBQUE7QUFJUEMsSUFBQUEsU0FBUyxFQUpGLEVBQUE7QUFLUEMsSUFBQUEsWUFBWSxFQUFFO0FBTFAsR0Fmc0I7QUFzQi9CbEIsRUFBQUEsSUFBSSxFQUFFO0FBQ0ptQixJQUFBQSxNQUFNLEVBQUU7QUFESixHQXRCeUI7QUF5Qi9CbEIsRUFBQUEsT0FBTyxFQUFFO0FBQ1BtQixJQUFBQSxJQUFJLEVBREcsQ0FBQTtBQUVQRCxJQUFBQSxNQUFNLEVBQUU7QUFGRCxHQXpCc0I7QUE2Qi9CakIsRUFBQUEsT0FBTyxFQUFFO0FBQ1BZLElBQUFBLGFBQWEsRUFETixLQUFBO0FBRVBDLElBQUFBLGNBQWMsRUFGUCxVQUFBO0FBR1BJLElBQUFBLE1BQU0sRUFBRTtBQUhELEdBN0JzQjtBQWtDL0JmLEVBQUFBLE1BQU0sRUFBRTtBQUNOZSxJQUFBQSxNQUFNLEVBQUU7QUFERjtBQWxDdUIsQ0FBbEIsQ0FBZjs7ZUF1Q2UsQ0FBQSxHQUFBLFFBQUEsQ0FBQSxTQUFBLEVBQUEsTUFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVmlldywgVmlld1N0eWxlLCBTdHlsZVNoZWV0LCBTdHlsZVByb3AsIEFuaW1hdGVkIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBTdXJmYWNlIGZyb20gJy4vU3VyZmFjZSc7XG5pbXBvcnQgVGV4dCBmcm9tICcuL1R5cG9ncmFwaHkvVGV4dCc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4vQnV0dG9uJztcbmltcG9ydCBJY29uLCB7IEljb25Tb3VyY2UgfSBmcm9tICcuL0ljb24nO1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnLi4vY29yZS90aGVtaW5nJztcbmltcG9ydCB0eXBlIHsgJFJlbW92ZUNoaWxkcmVuIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHNoYWRvdyBmcm9tICcuLi9zdHlsZXMvc2hhZG93JztcblxuY29uc3QgRUxFVkFUSU9OID0gMTtcbmNvbnN0IERFRkFVTFRfTUFYX1dJRFRIID0gOTYwO1xuXG50eXBlIFByb3BzID0gJFJlbW92ZUNoaWxkcmVuPHR5cGVvZiBTdXJmYWNlPiAmIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgYmFubmVyIGlzIGN1cnJlbnRseSB2aXNpYmxlLlxuICAgKi9cbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgLyoqXG4gICAqIENvbnRlbnQgdGhhdCB3aWxsIGJlIGRpc3BsYXllZCBpbnNpZGUgYmFubmVyLlxuICAgKi9cbiAgY2hpbGRyZW46IHN0cmluZztcbiAgLyoqXG4gICAqIEljb24gdG8gZGlzcGxheSBmb3IgdGhlIGBCYW5uZXJgLiBDYW4gYmUgYW4gaW1hZ2UuXG4gICAqL1xuICBpY29uPzogSWNvblNvdXJjZTtcbiAgLyoqXG4gICAqIEFjdGlvbiBpdGVtcyB0byBzaG93biBpbiB0aGUgYmFubmVyLlxuICAgKiBBbiBhY3Rpb24gaXRlbSBzaG91bGQgY29udGFpbiB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAqXG4gICAqIC0gYGxhYmVsYDogbGFiZWwgb2YgdGhlIGFjdGlvbiBidXR0b24gKHJlcXVpcmVkKVxuICAgKiAtIGBvblByZXNzYDogY2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiBidXR0b24gaXMgcHJlc3NlZCAocmVxdWlyZWQpXG4gICAqXG4gICAqIFRvIGN1c3RvbWl6ZSBidXR0b24geW91IGNhbiBwYXNzIG90aGVyIHByb3BzIHRoYXQgYnV0dG9uIGNvbXBvbmVudCB0YWtlcy5cbiAgICovXG4gIGFjdGlvbnM6IEFycmF5PHtcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIG9uUHJlc3M6ICgpID0+IHZvaWQ7XG4gIH0+O1xuICAvKipcbiAgICogU3R5bGUgb2YgYmFubmVyJ3MgaW5uZXIgY29udGVudC5cbiAgICogVXNlIHRoaXMgcHJvcCB0byBhcHBseSBjdXN0b20gd2lkdGggZm9yIHdpZGUgbGF5b3V0cy5cbiAgICovXG4gIGNvbnRlbnRTdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICBzdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICByZWY/OiBSZWFjdC5SZWZPYmplY3Q8Vmlldz47XG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICovXG4gIHRoZW1lOiBSZWFjdE5hdGl2ZVBhcGVyLlRoZW1lO1xufTtcblxudHlwZSBOYXRpdmVFdmVudCA9IHtcbiAgbmF0aXZlRXZlbnQ6IHtcbiAgICBsYXlvdXQ6IHtcbiAgICAgIHg6IG51bWJlcjtcbiAgICAgIHk6IG51bWJlcjtcbiAgICAgIHdpZHRoOiBudW1iZXI7XG4gICAgICBoZWlnaHQ6IG51bWJlcjtcbiAgICB9O1xuICB9O1xufTtcblxuLyoqXG4gKiBCYW5uZXIgZGlzcGxheXMgYSBwcm9taW5lbnQgbWVzc2FnZSBhbmQgcmVsYXRlZCBhY3Rpb25zLlxuICpcbiAqIDxkaXYgY2xhc3M9XCJzY3JlZW5zaG90c1wiPlxuICogICA8aW1nIGNsYXNzPVwibWVkaXVtXCIgc3JjPVwic2NyZWVuc2hvdHMvYmFubmVyLmdpZlwiIC8+XG4gKiA8L2Rpdj5cbiAqXG4gKiAjIyBVc2FnZVxuICogYGBganNcbiAqIGltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbiAqIGltcG9ydCB7IEltYWdlIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbiAqIGltcG9ydCB7IEJhbm5lciB9IGZyb20gJ3JlYWN0LW5hdGl2ZS1wYXBlcic7XG4gKlxuICogY29uc3QgTXlDb21wb25lbnQgPSAoKSA9PiB7XG4gKiAgIGNvbnN0IFt2aXNpYmxlLCBzZXRWaXNpYmxlXSA9IFJlYWN0LnVzZVN0YXRlKHRydWUpO1xuICpcbiAqICAgcmV0dXJuIChcbiAqICAgICA8QmFubmVyXG4gKiAgICAgICB2aXNpYmxlPXt2aXNpYmxlfVxuICogICAgICAgYWN0aW9ucz17W1xuICogICAgICAgICB7XG4gKiAgICAgICAgICAgbGFiZWw6ICdGaXggaXQnLFxuICogICAgICAgICAgIG9uUHJlc3M6ICgpID0+IHNldFZpc2libGUoZmFsc2UpLFxuICogICAgICAgICB9LFxuICogICAgICAgICB7XG4gKiAgICAgICAgICAgbGFiZWw6ICdMZWFybiBtb3JlJyxcbiAqICAgICAgICAgICBvblByZXNzOiAoKSA9PiBzZXRWaXNpYmxlKGZhbHNlKSxcbiAqICAgICAgICAgfSxcbiAqICAgICAgIF19XG4gKiAgICAgICBpY29uPXsoe3NpemV9KSA9PiAoXG4gKiAgICAgICAgIDxJbWFnZVxuICogICAgICAgICAgIHNvdXJjZT17e1xuICogICAgICAgICAgICAgdXJpOiAnaHR0cHM6Ly9hdmF0YXJzMy5naXRodWJ1c2VyY29udGVudC5jb20vdS8xNzU3MTk2OT9zPTQwMCZ2PTQnLFxuICogICAgICAgICAgIH19XG4gKiAgICAgICAgICAgc3R5bGU9e3tcbiAqICAgICAgICAgICAgIHdpZHRoOiBzaXplLFxuICogICAgICAgICAgICAgaGVpZ2h0OiBzaXplLFxuICogICAgICAgICAgIH19XG4gKiAgICAgICAgIC8+XG4gKiAgICAgICApfT5cbiAqICAgICAgIFRoZXJlIHdhcyBhIHByb2JsZW0gcHJvY2Vzc2luZyBhIHRyYW5zYWN0aW9uIG9uIHlvdXIgY3JlZGl0IGNhcmQuXG4gKiAgICAgPC9CYW5uZXI+XG4gKiAgICk7XG4gKiB9O1xuICpcbiAqIGV4cG9ydCBkZWZhdWx0IE15Q29tcG9uZW50O1xuICogYGBgXG4gKi9cbmNvbnN0IEJhbm5lciA9ICh7XG4gIHZpc2libGUsXG4gIGljb24sXG4gIGNoaWxkcmVuLFxuICBhY3Rpb25zLFxuICBjb250ZW50U3R5bGUsXG4gIHN0eWxlLFxuICB0aGVtZSxcbiAgLi4ucmVzdFxufTogUHJvcHMpID0+IHtcbiAgY29uc3QgeyBjdXJyZW50OiBwb3NpdGlvbiB9ID0gUmVhY3QudXNlUmVmPEFuaW1hdGVkLlZhbHVlPihcbiAgICBuZXcgQW5pbWF0ZWQuVmFsdWUodmlzaWJsZSA/IDEgOiAwKVxuICApO1xuICBjb25zdCBbbGF5b3V0LCBzZXRMYXlvdXRdID0gUmVhY3QudXNlU3RhdGU8e1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIG1lYXN1cmVkOiBib29sZWFuO1xuICB9Pih7XG4gICAgaGVpZ2h0OiAwLFxuICAgIG1lYXN1cmVkOiBmYWxzZSxcbiAgfSk7XG5cbiAgY29uc3QgeyBzY2FsZSB9ID0gdGhlbWUuYW5pbWF0aW9uO1xuXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHZpc2libGUpIHtcbiAgICAgIC8vIHNob3dcbiAgICAgIEFuaW1hdGVkLnRpbWluZyhwb3NpdGlvbiwge1xuICAgICAgICBkdXJhdGlvbjogMjUwICogc2NhbGUsXG4gICAgICAgIHRvVmFsdWU6IDEsXG4gICAgICAgIHVzZU5hdGl2ZURyaXZlcjogZmFsc2UsXG4gICAgICB9KS5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBoaWRlXG4gICAgICBBbmltYXRlZC50aW1pbmcocG9zaXRpb24sIHtcbiAgICAgICAgZHVyYXRpb246IDIwMCAqIHNjYWxlLFxuICAgICAgICB0b1ZhbHVlOiAwLFxuICAgICAgICB1c2VOYXRpdmVEcml2ZXI6IGZhbHNlLFxuICAgICAgfSkuc3RhcnQoKTtcbiAgICB9XG4gIH0sIFt2aXNpYmxlLCBwb3NpdGlvbiwgc2NhbGVdKTtcblxuICBjb25zdCBoYW5kbGVMYXlvdXQgPSAoeyBuYXRpdmVFdmVudCB9OiBOYXRpdmVFdmVudCkgPT4ge1xuICAgIGNvbnN0IHsgaGVpZ2h0IH0gPSBuYXRpdmVFdmVudC5sYXlvdXQ7XG4gICAgc2V0TGF5b3V0KHsgaGVpZ2h0LCBtZWFzdXJlZDogdHJ1ZSB9KTtcbiAgfTtcblxuICAvLyBUaGUgYmFubmVyIGFuaW1hdGlvbiBoYXMgMiBwYXJ0czpcbiAgLy8gMS4gQmxhbmsgc3BhY2VyIGVsZW1lbnQgd2hpY2ggYW5pbWF0ZXMgaXRzIGhlaWdodCB0byBtb3ZlIHRoZSBjb250ZW50XG4gIC8vIDIuIEFjdHVhbCBiYW5uZXIgd2hpY2ggYW5pbWF0ZXMgaXRzIHRyYW5zbGF0ZVlcbiAgLy8gSW4gaW5pdGlhbCByZW5kZXIsIHdlIHBvc2l0aW9uIGV2ZXJ5dGhpbmcgbm9ybWFsbHkgYW5kIG1lYXN1cmUgdGhlIGhlaWdodCBvZiB0aGUgYmFubmVyXG4gIC8vIE9uY2Ugd2UgaGF2ZSB0aGUgaGVpZ2h0LCB3ZSBhcHBseSB0aGUgaGVpZ2h0IHRvIHRoZSBzcGFjZXIgYW5kIHN3aXRjaCB0aGUgYmFubmVyIHRvIHBvc2l0aW9uOiBhYnNvbHV0ZVxuICAvLyBXZSBuZWVkIHRoaXMgYmVjYXVzZSB3ZSBuZWVkIHRvIG1vdmUgdGhlIGNvbnRlbnQgYmVsb3cgYXMgaWYgYmFubmVyJ3MgaGVpZ2h0IHdhcyBiZWluZyBhbmltYXRlZFxuICAvLyBIb3dldmVyIHdlIGNhbid0IGFuaW1hdGVkIGJhbm5lcidzIGhlaWdodCBkaXJlY3RseSBhcyBpdCdsbCBhbHNvIHJlc2l6ZSB0aGUgY29udGVudCBpbnNpZGVcbiAgY29uc3QgaGVpZ2h0ID0gQW5pbWF0ZWQubXVsdGlwbHkocG9zaXRpb24sIGxheW91dC5oZWlnaHQpO1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVkgPSBBbmltYXRlZC5tdWx0aXBseShcbiAgICBBbmltYXRlZC5hZGQocG9zaXRpb24sIC0xKSxcbiAgICBsYXlvdXQuaGVpZ2h0XG4gICk7XG4gIHJldHVybiAoXG4gICAgPFN1cmZhY2VcbiAgICAgIHsuLi5yZXN0fVxuICAgICAgc3R5bGU9e1tzdHlsZXMuY29udGFpbmVyLCBzaGFkb3coRUxFVkFUSU9OKSBhcyBWaWV3U3R5bGUsIHN0eWxlXX1cbiAgICA+XG4gICAgICA8VmlldyBzdHlsZT17W3N0eWxlcy53cmFwcGVyLCBjb250ZW50U3R5bGVdfT5cbiAgICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e3sgaGVpZ2h0IH19IC8+XG4gICAgICAgIDxBbmltYXRlZC5WaWV3XG4gICAgICAgICAgb25MYXlvdXQ9e2hhbmRsZUxheW91dH1cbiAgICAgICAgICBzdHlsZT17W1xuICAgICAgICAgICAgbGF5b3V0Lm1lYXN1cmVkIHx8ICF2aXNpYmxlXG4gICAgICAgICAgICAgID8gLy8gSWYgd2UgaGF2ZSBtZWFzdXJlZCBiYW5uZXIncyBoZWlnaHQgb3IgaXQncyBpbnZpc2libGUsXG4gICAgICAgICAgICAgICAgLy8gUG9zaXRpb24gaXQgYWJzb2x1dGVseSwgdGhlIGxheW91dCB3aWxsIGJlIHRha2VuIGNhcmUgb2YgdGhlIHNwYWNlclxuICAgICAgICAgICAgICAgIFtzdHlsZXMuYWJzb2x1dGUsIHsgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZIH1dIH1dXG4gICAgICAgICAgICAgIDogLy8gT3RoZXJ3aXNlIHBvc2l0aW9uIGl0IG5vcm1hbGx5XG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICFsYXlvdXQubWVhc3VyZWQgJiYgIXZpc2libGVcbiAgICAgICAgICAgICAgPyAvLyBJZiB3ZSBoYXZlbid0IG1lYXN1cmVkIGJhbm5lcidzIGhlaWdodCB5ZXQgYW5kIGl0J3MgaW52aXNpYmxlLFxuICAgICAgICAgICAgICAgIC8vIGhpZGUgaXQgd2l0aCBvcGFjaXR5OiAwIHNvIHVzZXIgZG9lc24ndCBzZWUgaXRcbiAgICAgICAgICAgICAgICB7IG9wYWNpdHk6IDAgfVxuICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgXX1cbiAgICAgICAgPlxuICAgICAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGVudH0+XG4gICAgICAgICAgICB7aWNvbiA/IChcbiAgICAgICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5pY29ufT5cbiAgICAgICAgICAgICAgICA8SWNvbiBzb3VyY2U9e2ljb259IHNpemU9ezQwfSAvPlxuICAgICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgIDxUZXh0IHN0eWxlPXtzdHlsZXMubWVzc2FnZX0+e2NoaWxkcmVufTwvVGV4dD5cbiAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5hY3Rpb25zfT5cbiAgICAgICAgICAgIHthY3Rpb25zLm1hcCgoeyBsYWJlbCwgLi4ub3RoZXJzIH0sIGkpID0+IChcbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIGtleT17LyogZXNsaW50LWRpc2FibGUtbGluZSByZWFjdC9uby1hcnJheS1pbmRleC1rZXkgKi8gaX1cbiAgICAgICAgICAgICAgICBjb21wYWN0XG4gICAgICAgICAgICAgICAgbW9kZT1cInRleHRcIlxuICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9ufVxuICAgICAgICAgICAgICAgIHsuLi5vdGhlcnN9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7bGFiZWx9XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgKSl9XG4gICAgICAgICAgPC9WaWV3PlxuICAgICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgICA8L1ZpZXc+XG4gICAgPC9TdXJmYWNlPlxuICApO1xufTtcblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBjb250YWluZXI6IHtcbiAgICBlbGV2YXRpb246IEVMRVZBVElPTixcbiAgfSxcbiAgd3JhcHBlcjoge1xuICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICBhbGlnblNlbGY6ICdjZW50ZXInLFxuICAgIHdpZHRoOiAnMTAwJScsXG4gICAgbWF4V2lkdGg6IERFRkFVTFRfTUFYX1dJRFRILFxuICB9LFxuICBhYnNvbHV0ZToge1xuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHRvcDogMCxcbiAgICB3aWR0aDogJzEwMCUnLFxuICB9LFxuICBjb250ZW50OiB7XG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LXN0YXJ0JyxcbiAgICBtYXJnaW5Ib3Jpem9udGFsOiA4LFxuICAgIG1hcmdpblRvcDogMTYsXG4gICAgbWFyZ2luQm90dG9tOiAwLFxuICB9LFxuICBpY29uOiB7XG4gICAgbWFyZ2luOiA4LFxuICB9LFxuICBtZXNzYWdlOiB7XG4gICAgZmxleDogMSxcbiAgICBtYXJnaW46IDgsXG4gIH0sXG4gIGFjdGlvbnM6IHtcbiAgICBmbGV4RGlyZWN0aW9uOiAncm93JyxcbiAgICBqdXN0aWZ5Q29udGVudDogJ2ZsZXgtZW5kJyxcbiAgICBtYXJnaW46IDQsXG4gIH0sXG4gIGJ1dHRvbjoge1xuICAgIG1hcmdpbjogNCxcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoVGhlbWUoQmFubmVyKTtcbiJdfQ==