2e5971bda5d655472fc0f2a03cb4fc27
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.calculateFlatAffixTopPosition = calculateFlatAffixTopPosition;
exports.calculateOutlinedIconAndAffixTopPosition = calculateOutlinedIconAndAffixTopPosition;
exports.calculateFlatInputHorizontalPadding = exports.interpolatePlaceholder = exports.adjustPaddingFlat = exports.adjustPaddingOut = exports.calculatePadding = exports.calculateInputHeight = exports.calculateLabelTopPosition = void 0;

var _constants = require("./constants");

var _enums = require("./Adornment/enums");

var calculateLabelTopPosition = function calculateLabelTopPosition(labelHeight) {
  var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
  var optionalPadding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
  var customHeight = height > 0 ? height : 0;
  return Math.floor((customHeight - labelHeight) / 2 + optionalPadding);
};

exports.calculateLabelTopPosition = calculateLabelTopPosition;

var calculateInputHeight = function calculateInputHeight(labelHeight) {
  var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
  var minHeight = arguments.length > 2 ? arguments[2] : undefined;
  var finalHeight = height > 0 ? height : labelHeight;
  if (height > 0) return height;
  return finalHeight < minHeight ? minHeight : finalHeight;
};

exports.calculateInputHeight = calculateInputHeight;

var calculatePadding = function calculatePadding(props) {
  var height = props.height,
      _props$multiline = props.multiline,
      multiline = _props$multiline === void 0 ? false : _props$multiline;
  var result = 0;

  if (multiline) {
    if (height && multiline) {
      result = calculateTextAreaPadding(props);
    } else {
      result = calculateInputPadding(props);
    }
  }

  return Math.max(0, result);
};

exports.calculatePadding = calculatePadding;

var calculateTextAreaPadding = function calculateTextAreaPadding(props) {
  var dense = props.dense;
  return dense ? 10 : 20;
};

var calculateInputPadding = function calculateInputPadding(_ref) {
  var topPosition = _ref.topPosition,
      fontSize = _ref.fontSize,
      multiline = _ref.multiline,
      scale = _ref.scale,
      dense = _ref.dense,
      offset = _ref.offset,
      isAndroid = _ref.isAndroid;
  var refFontSize = scale * fontSize;
  var result = Math.floor(topPosition / 2);
  result = result + Math.floor((refFontSize - fontSize) / 2) - (scale < 1 ? offset / 2 : 0);
  if (multiline && isAndroid) result = Math.min(dense ? offset / 2 : offset, result);
  return result;
};

var adjustPaddingOut = function adjustPaddingOut(_ref2) {
  var pad = _ref2.pad,
      multiline = _ref2.multiline,
      label = _ref2.label,
      scale = _ref2.scale,
      height = _ref2.height,
      fontSize = _ref2.fontSize,
      dense = _ref2.dense,
      offset = _ref2.offset,
      isAndroid = _ref2.isAndroid;
  var refFontSize = scale * fontSize;
  var result = pad;

  if (height) {
    return {
      paddingTop: Math.max(0, (height - fontSize) / 2),
      paddingBottom: Math.max(0, (height - fontSize) / 2)
    };
  }

  if (!isAndroid && multiline) {
    if (dense) {
      if (label) {
        result += scale < 1 ? Math.min(offset, refFontSize / 2 * scale) : 0;
      } else {
        result += 0;
      }
    }

    if (!dense) {
      if (label) {
        result += scale < 1 ? Math.min(offset, refFontSize * scale) : Math.min(offset / 2, refFontSize * scale);
      } else {
        result += scale < 1 ? Math.min(offset / 2, refFontSize * scale) : 0;
      }
    }

    result = Math.floor(result);
  }

  return {
    paddingTop: result,
    paddingBottom: result
  };
};

exports.adjustPaddingOut = adjustPaddingOut;

var adjustPaddingFlat = function adjustPaddingFlat(_ref3) {
  var pad = _ref3.pad,
      scale = _ref3.scale,
      multiline = _ref3.multiline,
      label = _ref3.label,
      height = _ref3.height,
      offset = _ref3.offset,
      dense = _ref3.dense,
      fontSize = _ref3.fontSize,
      isAndroid = _ref3.isAndroid,
      styles = _ref3.styles;
  var result = pad;
  var topResult = result;
  var bottomResult = result;
  var paddingTop = styles.paddingTop,
      paddingBottom = styles.paddingBottom;
  var refFontSize = scale * fontSize;

  if (!multiline) {
    if (label) {
      return {
        paddingTop: paddingTop,
        paddingBottom: paddingBottom
      };
    }

    return {
      paddingTop: result,
      paddingBottom: result
    };
  }

  if (label) {
    topResult = paddingTop;
    bottomResult = paddingBottom;

    if (!isAndroid) {
      if (dense) {
        topResult += scale < 1 ? Math.min(result, refFontSize * scale) - result / 2 : Math.min(result, refFontSize * scale) - result / 2;
      }

      if (!dense) {
        topResult += scale < 1 ? Math.min(offset / 2, refFontSize * scale) : Math.min(result, refFontSize * scale) - offset / 2;
      }
    }

    topResult = Math.floor(topResult);
  } else {
    if (height) {
      return {
        paddingTop: Math.max(0, (height - fontSize) / 2),
        paddingBottom: Math.max(0, (height - fontSize) / 2)
      };
    }

    if (!isAndroid) {
      if (dense) {
        result += scale < 1 ? Math.min(offset / 2, fontSize / 2 * scale) : Math.min(offset / 2, scale);
      }

      if (!dense) {
        result += scale < 1 ? Math.min(offset, fontSize * scale) : Math.min(fontSize, offset / 2 * scale);
      }

      result = Math.floor(result);
      topResult = result;
      bottomResult = result;
    }
  }

  return {
    paddingTop: Math.max(0, topResult),
    paddingBottom: Math.max(0, bottomResult)
  };
};

exports.adjustPaddingFlat = adjustPaddingFlat;

var interpolatePlaceholder = function interpolatePlaceholder(labeled, hasActiveOutline) {
  return labeled.interpolate({
    inputRange: [0, 1],
    outputRange: [hasActiveOutline ? 0 : 1, 1]
  });
};

exports.interpolatePlaceholder = interpolatePlaceholder;

function calculateFlatAffixTopPosition(_ref4) {
  var height = _ref4.height,
      paddingTop = _ref4.paddingTop,
      paddingBottom = _ref4.paddingBottom,
      affixHeight = _ref4.affixHeight;
  var inputHeightWithoutPadding = height - paddingTop - paddingBottom;
  var halfOfTheInputHeightDecreasedByAffixHeight = (inputHeightWithoutPadding - affixHeight) / 2;
  return paddingTop + halfOfTheInputHeightDecreasedByAffixHeight;
}

function calculateOutlinedIconAndAffixTopPosition(_ref5) {
  var height = _ref5.height,
      affixHeight = _ref5.affixHeight,
      labelYOffset = _ref5.labelYOffset;
  return (height - affixHeight + labelYOffset) / 2;
}

var calculateFlatInputHorizontalPadding = function calculateFlatInputHorizontalPadding(_ref6) {
  var adornmentConfig = _ref6.adornmentConfig;
  var paddingLeft = _constants.LABEL_PADDING_HORIZONTAL;
  var paddingRight = _constants.LABEL_PADDING_HORIZONTAL;
  adornmentConfig.forEach(function (_ref7) {
    var type = _ref7.type,
        side = _ref7.side;

    if (type === _enums.AdornmentType.Icon && side === _enums.AdornmentSide.Left) {
      paddingLeft = _constants.ADORNMENT_SIZE + _constants.ADORNMENT_OFFSET + _constants.FLAT_INPUT_OFFSET;
    } else if (side === _enums.AdornmentSide.Right) {
      if (type === _enums.AdornmentType.Affix) {
        paddingRight = _constants.ADORNMENT_SIZE + _constants.ADORNMENT_OFFSET + _constants.FLAT_INPUT_OFFSET;
      } else if (type === _enums.AdornmentType.Icon) {
        paddingRight = _constants.ADORNMENT_SIZE + _constants.ADORNMENT_OFFSET + _constants.FLAT_INPUT_OFFSET;
      }
    }
  });
  return {
    paddingLeft: paddingLeft,
    paddingRight: paddingRight
  };
};

exports.calculateFlatInputHorizontalPadding = calculateFlatInputHorizontalPadding;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhlbHBlcnMudHN4Il0sIm5hbWVzIjpbImNhbGN1bGF0ZUxhYmVsVG9wUG9zaXRpb24iLCJoZWlnaHQiLCJvcHRpb25hbFBhZGRpbmciLCJjdXN0b21IZWlnaHQiLCJNYXRoIiwiY2FsY3VsYXRlSW5wdXRIZWlnaHQiLCJmaW5hbEhlaWdodCIsImNhbGN1bGF0ZVBhZGRpbmciLCJwcm9wcyIsIm11bHRpbGluZSIsInJlc3VsdCIsImNhbGN1bGF0ZVRleHRBcmVhUGFkZGluZyIsImNhbGN1bGF0ZUlucHV0UGFkZGluZyIsImRlbnNlIiwiaXNBbmRyb2lkIiwicmVmRm9udFNpemUiLCJzY2FsZSIsInRvcFBvc2l0aW9uIiwib2Zmc2V0IiwiYWRqdXN0UGFkZGluZ091dCIsInBhZGRpbmdUb3AiLCJwYWRkaW5nQm90dG9tIiwiYWRqdXN0UGFkZGluZ0ZsYXQiLCJzdHlsZXMiLCJ0b3BSZXN1bHQiLCJib3R0b21SZXN1bHQiLCJmb250U2l6ZSIsImludGVycG9sYXRlUGxhY2Vob2xkZXIiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJoYXNBY3RpdmVPdXRsaW5lIiwiYWZmaXhIZWlnaHQiLCJpbnB1dEhlaWdodFdpdGhvdXRQYWRkaW5nIiwiaGFsZk9mVGhlSW5wdXRIZWlnaHREZWNyZWFzZWRCeUFmZml4SGVpZ2h0IiwibGFiZWxZT2Zmc2V0IiwiY2FsY3VsYXRlRmxhdElucHV0SG9yaXpvbnRhbFBhZGRpbmciLCJhZG9ybm1lbnRDb25maWciLCJwYWRkaW5nTGVmdCIsIkxBQkVMX1BBRERJTkdfSE9SSVpPTlRBTCIsInBhZGRpbmdSaWdodCIsInNpZGUiLCJ0eXBlIiwiQWRvcm5tZW50VHlwZSIsIkFkb3JubWVudFNpZGUiLCJBRE9STk1FTlRfU0laRSIsIkFET1JOTUVOVF9PRkZTRVQiLCJGTEFUX0lOUFVUX09GRlNFVCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBRUEsSUFBQSxVQUFBLEdBQUEsT0FBQSxlQUFBOztBQU1BLElBQUEsTUFBQSxHQUFBLE9BQUEscUJBQUE7O0FBc0JPLElBQU1BLHlCQUF5QixHQUFHLFNBQTVCQSx5QkFBNEIsQ0FBQSxXQUFBLEVBSTVCO0FBQUEsTUFGWEMsTUFFVyx1RUFKNEIsQ0FJNUI7QUFBQSxNQURYQyxlQUNXLHVFQUo0QixDQUk1QjtBQUNYLE1BQU1DLFlBQVksR0FBR0YsTUFBTSxHQUFOQSxDQUFBQSxHQUFBQSxNQUFBQSxHQUFyQixDQUFBO0FBRUEsU0FBT0csSUFBSSxDQUFKQSxLQUFBQSxDQUFXLENBQUNELFlBQVksR0FBYixXQUFBLElBQUEsQ0FBQSxHQUFsQixlQUFPQyxDQUFQO0FBUEssQ0FBQTs7OztBQVVBLElBQU1DLG9CQUFvQixHQUFHLFNBQXZCQSxvQkFBdUIsQ0FBQSxXQUFBLEVBSXZCO0FBQUEsTUFGWEosTUFFVyx1RUFKdUIsQ0FJdkI7QUFBQSxNQUp1QixTQUl2QjtBQUNYLE1BQU1LLFdBQVcsR0FBR0wsTUFBTSxHQUFOQSxDQUFBQSxHQUFBQSxNQUFBQSxHQUFwQixXQUFBO0FBRUEsTUFBSUEsTUFBTSxHQUFWLENBQUEsRUFBZ0IsT0FBQSxNQUFBO0FBQ2hCLFNBQU9LLFdBQVcsR0FBWEEsU0FBQUEsR0FBQUEsU0FBQUEsR0FBUCxXQUFBO0FBUkssQ0FBQTs7OztBQVdBLElBQU1DLGdCQUFnQixHQUFJQyxTQUFwQkQsZ0JBQW9CQyxDQUFBQSxLQUFELEVBQWlDO0FBQy9ELE1BQU0sTUFBTixHQUFBLEtBQUEsQ0FBTSxNQUFOO0FBQUEseUJBQUEsS0FBQSxDQUFnQkMsU0FBaEI7QUFBQSxNQUFnQkEsU0FBaEIsaUNBQTRCLEtBQTVCO0FBRUEsTUFBSUMsTUFBTSxHQUFWLENBQUE7O0FBRUEsTUFBQSxTQUFBLEVBQWU7QUFDYixRQUFJVCxNQUFNLElBQVYsU0FBQSxFQUF5QjtBQUN2QlMsTUFBQUEsTUFBTSxHQUFHQyx3QkFBd0IsQ0FBakNELEtBQWlDLENBQWpDQTtBQURGLEtBQUEsTUFFTztBQUNMQSxNQUFBQSxNQUFNLEdBQUdFLHFCQUFxQixDQUE5QkYsS0FBOEIsQ0FBOUJBO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPTixJQUFJLENBQUpBLEdBQUFBLENBQUFBLENBQUFBLEVBQVAsTUFBT0EsQ0FBUDtBQWJLLENBQUE7Ozs7QUFnQlAsSUFBTU8sd0JBQXdCLEdBQUlILFNBQTVCRyx3QkFBNEJILENBQUFBLEtBQUQsRUFBeUI7QUFDeEQsTUFBUUssS0FBUixHQUFBLEtBQUEsQ0FBUUEsS0FBUjtBQUVBLFNBQU9BLEtBQUssR0FBQSxFQUFBLEdBQVosRUFBQTtBQUhGLENBQUE7O0FBTUEsSUFBTUQscUJBQXFCLEdBQUcsU0FBeEJBLHFCQUF3QixPQVFGO0FBQUEsTUFSRyxXQVFILFFBUkcsV0FRSDtBQUFBLE1BUkcsUUFRSCxRQVJHLFFBUUg7QUFBQSxNQVJHLFNBUUgsUUFSRyxTQVFIO0FBQUEsTUFSRyxLQVFILFFBUkcsS0FRSDtBQUFBLE1BUkcsS0FRSCxRQVJHLEtBUUg7QUFBQSxNQVJHLE1BUUgsUUFSRyxNQVFIO0FBQUEsTUFEMUJFLFNBQzBCLFFBRDFCQSxTQUMwQjtBQUMxQixNQUFNQyxXQUFXLEdBQUdDLEtBQUssR0FBekIsUUFBQTtBQUNBLE1BQUlOLE1BQU0sR0FBR04sSUFBSSxDQUFKQSxLQUFBQSxDQUFXYSxXQUFXLEdBQW5DLENBQWFiLENBQWI7QUFFQU0sRUFBQUEsTUFBTSxHQUNKQSxNQUFNLEdBQ05OLElBQUksQ0FBSkEsS0FBQUEsQ0FBVyxDQUFDVyxXQUFXLEdBQVosUUFBQSxJQURYTCxDQUNBTixDQURBTSxJQUVDTSxLQUFLLEdBQUxBLENBQUFBLEdBQVlFLE1BQU0sR0FBbEJGLENBQUFBLEdBSEhOLENBQ0VBLENBREZBO0FBS0EsTUFBSUQsU0FBUyxJQUFiLFNBQUEsRUFDRUMsTUFBTSxHQUFHTixJQUFJLENBQUpBLEdBQUFBLENBQVNTLEtBQUssR0FBR0ssTUFBTSxHQUFULENBQUEsR0FBZGQsTUFBQUEsRUFBVE0sTUFBU04sQ0FBVE07QUFFRixTQUFBLE1BQUE7QUFwQkYsQ0FBQTs7QUF1Qk8sSUFBTVMsZ0JBQWdCLEdBQUcsU0FBbkJBLGdCQUFtQixRQVVQO0FBQUEsTUFWUSxHQVVSLFNBVlEsR0FVUjtBQUFBLE1BVlEsU0FVUixTQVZRLFNBVVI7QUFBQSxNQVZRLEtBVVIsU0FWUSxLQVVSO0FBQUEsTUFWUSxLQVVSLFNBVlEsS0FVUjtBQUFBLE1BVlEsTUFVUixTQVZRLE1BVVI7QUFBQSxNQVZRLFFBVVIsU0FWUSxRQVVSO0FBQUEsTUFWUSxLQVVSLFNBVlEsS0FVUjtBQUFBLE1BVlEsTUFVUixTQVZRLE1BVVI7QUFBQSxNQUR2QkwsU0FDdUIsU0FEdkJBLFNBQ3VCO0FBQ3ZCLE1BQU1DLFdBQVcsR0FBR0MsS0FBSyxHQUF6QixRQUFBO0FBQ0EsTUFBSU4sTUFBTSxHQUFWLEdBQUE7O0FBRUEsTUFBQSxNQUFBLEVBQVk7QUFDVixXQUFPO0FBQ0xVLE1BQUFBLFVBQVUsRUFBRWhCLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsQ0FBQUEsRUFBWSxDQUFDSCxNQUFNLEdBQVAsUUFBQSxJQURuQixDQUNPRyxDQURQO0FBRUxpQixNQUFBQSxhQUFhLEVBQUVqQixJQUFJLENBQUpBLEdBQUFBLENBQUFBLENBQUFBLEVBQVksQ0FBQ0gsTUFBTSxHQUFQLFFBQUEsSUFBWkcsQ0FBQUE7QUFGVixLQUFQO0FBSUQ7O0FBQ0QsTUFBSSxDQUFBLFNBQUEsSUFBSixTQUFBLEVBQTZCO0FBQzNCLFFBQUEsS0FBQSxFQUFXO0FBQ1QsVUFBQSxLQUFBLEVBQVc7QUFDVE0sUUFBQUEsTUFBTSxJQUFJTSxLQUFLLEdBQUxBLENBQUFBLEdBQVlaLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsTUFBQUEsRUFBa0JXLFdBQVcsR0FBWixDQUFDQSxHQUE5QkMsS0FBWVosQ0FBWlksR0FBVk4sQ0FBQUE7QUFERixPQUFBLE1BRU87QUFDTEEsUUFBQUEsTUFBTSxJQUFOQSxDQUFBQTtBQUNEO0FBQ0Y7O0FBQ0QsUUFBSSxDQUFKLEtBQUEsRUFBWTtBQUNWLFVBQUEsS0FBQSxFQUFXO0FBQ1RBLFFBQUFBLE1BQU0sSUFDSk0sS0FBSyxHQUFMQSxDQUFBQSxHQUNJWixJQUFJLENBQUpBLEdBQUFBLENBQUFBLE1BQUFBLEVBQWlCVyxXQUFXLEdBRGhDQyxLQUNJWixDQURKWSxHQUVJWixJQUFJLENBQUpBLEdBQUFBLENBQVNjLE1BQU0sR0FBZmQsQ0FBQUEsRUFBcUJXLFdBQVcsR0FIdENMLEtBR01OLENBSE5NO0FBREYsT0FBQSxNQUtPO0FBQ0xBLFFBQUFBLE1BQU0sSUFBSU0sS0FBSyxHQUFMQSxDQUFBQSxHQUFZWixJQUFJLENBQUpBLEdBQUFBLENBQVNjLE1BQU0sR0FBZmQsQ0FBQUEsRUFBcUJXLFdBQVcsR0FBNUNDLEtBQVlaLENBQVpZLEdBQVZOLENBQUFBO0FBQ0Q7QUFDRjs7QUFDREEsSUFBQUEsTUFBTSxHQUFHTixJQUFJLENBQUpBLEtBQUFBLENBQVRNLE1BQVNOLENBQVRNO0FBQ0Q7O0FBQ0QsU0FBTztBQUFFVSxJQUFBQSxVQUFVLEVBQVosTUFBQTtBQUFzQkMsSUFBQUEsYUFBYSxFQUFFWDtBQUFyQyxHQUFQO0FBeENLLENBQUE7Ozs7QUEyQ0EsSUFBTVksaUJBQWlCLEdBQUcsU0FBcEJBLGlCQUFvQixRQVdSO0FBQUEsTUFYUyxHQVdULFNBWFMsR0FXVDtBQUFBLE1BWFMsS0FXVCxTQVhTLEtBV1Q7QUFBQSxNQVhTLFNBV1QsU0FYUyxTQVdUO0FBQUEsTUFYUyxLQVdULFNBWFMsS0FXVDtBQUFBLE1BWFMsTUFXVCxTQVhTLE1BV1Q7QUFBQSxNQVhTLE1BV1QsU0FYUyxNQVdUO0FBQUEsTUFYUyxLQVdULFNBWFMsS0FXVDtBQUFBLE1BWFMsUUFXVCxTQVhTLFFBV1Q7QUFBQSxNQVhTLFNBV1QsU0FYUyxTQVdUO0FBQUEsTUFEdkJDLE1BQ3VCLFNBRHZCQSxNQUN1QjtBQUN2QixNQUFJYixNQUFNLEdBQVYsR0FBQTtBQUNBLE1BQUljLFNBQVMsR0FBYixNQUFBO0FBQ0EsTUFBSUMsWUFBWSxHQUFoQixNQUFBO0FBQ0EsTUFBTSxVQUFOLEdBQUEsTUFBQSxDQUFNLFVBQU47QUFBQSxNQUFvQkosYUFBcEIsR0FBQSxNQUFBLENBQW9CQSxhQUFwQjtBQUNBLE1BQU1OLFdBQVcsR0FBR0MsS0FBSyxHQUF6QixRQUFBOztBQUVBLE1BQUksQ0FBSixTQUFBLEVBQWdCO0FBRWQsUUFBQSxLQUFBLEVBQVc7QUFFVCxhQUFPO0FBQUVJLFFBQUFBLFVBQUYsRUFBRUEsVUFBRjtBQUFjQyxRQUFBQSxhQUFBQSxFQUFBQTtBQUFkLE9BQVA7QUFKWTs7QUFPZCxXQUFPO0FBQUVELE1BQUFBLFVBQVUsRUFBWixNQUFBO0FBQXNCQyxNQUFBQSxhQUFhLEVBQUVYO0FBQXJDLEtBQVA7QUFDRDs7QUFFRCxNQUFBLEtBQUEsRUFBVztBQUVUYyxJQUFBQSxTQUFTLEdBQVRBLFVBQUFBO0FBQ0FDLElBQUFBLFlBQVksR0FISCxhQUdUQTs7QUFHQSxRQUFJLENBQUosU0FBQSxFQUFnQjtBQUNkLFVBQUEsS0FBQSxFQUFXO0FBQ1RELFFBQUFBLFNBQVMsSUFDUFIsS0FBSyxHQUFMQSxDQUFBQSxHQUNJWixJQUFJLENBQUpBLEdBQUFBLENBQUFBLE1BQUFBLEVBQWlCVyxXQUFXLEdBQTVCWCxLQUFBQSxJQUF3Q00sTUFBTSxHQURsRE0sQ0FBQUEsR0FFSVosSUFBSSxDQUFKQSxHQUFBQSxDQUFBQSxNQUFBQSxFQUFpQlcsV0FBVyxHQUE1QlgsS0FBQUEsSUFBd0NNLE1BQU0sR0FIcERjLENBQUFBO0FBSUQ7O0FBQ0QsVUFBSSxDQUFKLEtBQUEsRUFBWTtBQUNWQSxRQUFBQSxTQUFTLElBQ1BSLEtBQUssR0FBTEEsQ0FBQUEsR0FDSVosSUFBSSxDQUFKQSxHQUFBQSxDQUFTYyxNQUFNLEdBQWZkLENBQUFBLEVBQXFCVyxXQUFXLEdBRHBDQyxLQUNJWixDQURKWSxHQUVJWixJQUFJLENBQUpBLEdBQUFBLENBQUFBLE1BQUFBLEVBQWlCVyxXQUFXLEdBQTVCWCxLQUFBQSxJQUF3Q2MsTUFBTSxHQUhwRE0sQ0FBQUE7QUFJRDtBQUNGOztBQUNEQSxJQUFBQSxTQUFTLEdBQUdwQixJQUFJLENBQUpBLEtBQUFBLENBQVpvQixTQUFZcEIsQ0FBWm9CO0FBcEJGLEdBQUEsTUFxQk87QUFDTCxRQUFBLE1BQUEsRUFBWTtBQUVWLGFBQU87QUFDTEosUUFBQUEsVUFBVSxFQUFFaEIsSUFBSSxDQUFKQSxHQUFBQSxDQUFBQSxDQUFBQSxFQUFZLENBQUNILE1BQU0sR0FBUCxRQUFBLElBRG5CLENBQ09HLENBRFA7QUFFTGlCLFFBQUFBLGFBQWEsRUFBRWpCLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsQ0FBQUEsRUFBWSxDQUFDSCxNQUFNLEdBQVAsUUFBQSxJQUFaRyxDQUFBQTtBQUZWLE9BQVA7QUFIRzs7QUFTTCxRQUFJLENBQUosU0FBQSxFQUFnQjtBQUNkLFVBQUEsS0FBQSxFQUFXO0FBQ1RNLFFBQUFBLE1BQU0sSUFDSk0sS0FBSyxHQUFMQSxDQUFBQSxHQUNJWixJQUFJLENBQUpBLEdBQUFBLENBQVNjLE1BQU0sR0FBZmQsQ0FBQUEsRUFBc0JzQixRQUFRLEdBQVQsQ0FBQ0EsR0FEMUJWLEtBQ0laLENBREpZLEdBRUlaLElBQUksQ0FBSkEsR0FBQUEsQ0FBU2MsTUFBTSxHQUFmZCxDQUFBQSxFQUhOTSxLQUdNTixDQUhOTTtBQUlEOztBQUNELFVBQUksQ0FBSixLQUFBLEVBQVk7QUFDVkEsUUFBQUEsTUFBTSxJQUNKTSxLQUFLLEdBQUxBLENBQUFBLEdBQ0laLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsTUFBQUEsRUFBaUJzQixRQUFRLEdBRDdCVixLQUNJWixDQURKWSxHQUVJWixJQUFJLENBQUpBLEdBQUFBLENBQUFBLFFBQUFBLEVBQW9CYyxNQUFNLEdBQVAsQ0FBQ0EsR0FIMUJSLEtBR01OLENBSE5NO0FBSUQ7O0FBRURBLE1BQUFBLE1BQU0sR0FBR04sSUFBSSxDQUFKQSxLQUFBQSxDQUFUTSxNQUFTTixDQUFUTTtBQUNBYyxNQUFBQSxTQUFTLEdBQVRBLE1BQUFBO0FBQ0FDLE1BQUFBLFlBQVksR0FBWkEsTUFBQUE7QUFDRDtBQUNGOztBQUVELFNBQU87QUFDTEwsSUFBQUEsVUFBVSxFQUFFaEIsSUFBSSxDQUFKQSxHQUFBQSxDQUFBQSxDQUFBQSxFQURQLFNBQ09BLENBRFA7QUFFTGlCLElBQUFBLGFBQWEsRUFBRWpCLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsQ0FBQUEsRUFBQUEsWUFBQUE7QUFGVixHQUFQO0FBOUVLLENBQUE7Ozs7QUFvRkEsSUFBTXVCLHNCQUFzQixHQUFHLFNBQXpCQSxzQkFBeUIsQ0FBQSxPQUFBLEVBQUEsZ0JBQUE7QUFBQSxTQUlwQyxPQUFPLENBQVAsV0FBQSxDQUFvQjtBQUNsQkMsSUFBQUEsVUFBVSxFQUFFLENBQUEsQ0FBQSxFQURNLENBQ04sQ0FETTtBQUVsQkMsSUFBQUEsV0FBVyxFQUFFLENBQUNDLGdCQUFnQixHQUFBLENBQUEsR0FBakIsQ0FBQSxFQUFBLENBQUE7QUFGSyxHQUFwQixDQUpvQztBQUFBLENBQS9COzs7O0FBU0EsU0FBQSw2QkFBQSxRQVVJO0FBQUEsTUFWbUMsTUFVbkMsU0FWbUMsTUFVbkM7QUFBQSxNQVZtQyxVQVVuQyxTQVZtQyxVQVVuQztBQUFBLE1BVm1DLGFBVW5DLFNBVm1DLGFBVW5DO0FBQUEsTUFOVEMsV0FNUyxTQU5UQSxXQU1TO0FBQ1QsTUFBTUMseUJBQXlCLEdBQUcvQixNQUFNLEdBQU5BLFVBQUFBLEdBQWxDLGFBQUE7QUFFQSxNQUFNZ0MsMENBQTBDLEdBQzlDLENBQUNELHlCQUF5QixHQUExQixXQUFBLElBREYsQ0FBQTtBQUdBLFNBQU9aLFVBQVUsR0FBakIsMENBQUE7QUFDRDs7QUFFTSxTQUFBLHdDQUFBLFFBUUk7QUFBQSxNQVI4QyxNQVE5QyxTQVI4QyxNQVE5QztBQUFBLE1BUjhDLFdBUTlDLFNBUjhDLFdBUTlDO0FBQUEsTUFMVGMsWUFLUyxTQUxUQSxZQUtTO0FBQ1QsU0FBTyxDQUFDakMsTUFBTSxHQUFOQSxXQUFBQSxHQUFELFlBQUEsSUFBUCxDQUFBO0FBQ0Q7O0FBRU0sSUFBTWtDLG1DQUFtQyxHQUFHLFNBQXRDQSxtQ0FBc0MsUUFJN0M7QUFBQSxNQUhKQyxlQUdJLFNBSEpBLGVBR0k7QUFDSixNQUFJQyxXQUFXLEdBQUdDLFVBQUFBLENBQWxCLHdCQUFBO0FBQ0EsTUFBSUMsWUFBWSxHQUFHRCxVQUFBQSxDQUFuQix3QkFBQTtBQUVBRixFQUFBQSxlQUFlLENBQWZBLE9BQUFBLENBQXdCLGlCQUFvQjtBQUFBLFFBQW5CLElBQW1CLFNBQW5CLElBQW1CO0FBQUEsUUFBWEksSUFBVyxTQUFYQSxJQUFXOztBQUMxQyxRQUFJQyxJQUFJLEtBQUtDLE1BQUFBLENBQUFBLGFBQUFBLENBQVRELElBQUFBLElBQStCRCxJQUFJLEtBQUtHLE1BQUFBLENBQUFBLGFBQUFBLENBQTVDLElBQUEsRUFBZ0U7QUFDOUROLE1BQUFBLFdBQVcsR0FBR08sVUFBQUEsQ0FBQUEsY0FBQUEsR0FBaUJDLFVBQUFBLENBQWpCRCxnQkFBQUEsR0FBb0NFLFVBQUFBLENBQWxEVCxpQkFBQUE7QUFERixLQUFBLE1BRU8sSUFBSUcsSUFBSSxLQUFLRyxNQUFBQSxDQUFBQSxhQUFBQSxDQUFiLEtBQUEsRUFBa0M7QUFDdkMsVUFBSUYsSUFBSSxLQUFLQyxNQUFBQSxDQUFBQSxhQUFBQSxDQUFiLEtBQUEsRUFBa0M7QUFDaENILFFBQUFBLFlBQVksR0FBR0ssVUFBQUEsQ0FBQUEsY0FBQUEsR0FBaUJDLFVBQUFBLENBQWpCRCxnQkFBQUEsR0FBb0NFLFVBQUFBLENBQW5EUCxpQkFBQUE7QUFERixPQUFBLE1BRU8sSUFBSUUsSUFBSSxLQUFLQyxNQUFBQSxDQUFBQSxhQUFBQSxDQUFiLElBQUEsRUFBaUM7QUFDdENILFFBQUFBLFlBQVksR0FBR0ssVUFBQUEsQ0FBQUEsY0FBQUEsR0FBaUJDLFVBQUFBLENBQWpCRCxnQkFBQUEsR0FBb0NFLFVBQUFBLENBQW5EUCxpQkFBQUE7QUFDRDtBQUNGO0FBVEhILEdBQUFBO0FBWUEsU0FBTztBQUFFQyxJQUFBQSxXQUFGLEVBQUVBLFdBQUY7QUFBZUUsSUFBQUEsWUFBQUEsRUFBQUE7QUFBZixHQUFQO0FBcEJLLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEFuaW1hdGVkIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCB0eXBlIHsgQWRvcm5tZW50Q29uZmlnIH0gZnJvbSAnLi9BZG9ybm1lbnQvdHlwZXMnO1xuaW1wb3J0IHtcbiAgTEFCRUxfUEFERElOR19IT1JJWk9OVEFMLFxuICBBRE9STk1FTlRfT0ZGU0VULFxuICBBRE9STk1FTlRfU0laRSxcbiAgRkxBVF9JTlBVVF9PRkZTRVQsXG59IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IEFkb3JubWVudFR5cGUsIEFkb3JubWVudFNpZGUgfSBmcm9tICcuL0Fkb3JubWVudC9lbnVtcyc7XG5cbnR5cGUgUGFkZGluZ1Byb3BzID0ge1xuICBoZWlnaHQ6IG51bWJlciB8IG51bGw7XG4gIGxhYmVsSGFsZkhlaWdodDogbnVtYmVyO1xuICBtdWx0aWxpbmU6IGJvb2xlYW4gfCBudWxsO1xuICBkZW5zZTogYm9vbGVhbiB8IG51bGw7XG4gIHRvcFBvc2l0aW9uOiBudW1iZXI7XG4gIGZvbnRTaXplOiBudW1iZXI7XG4gIGxhYmVsPzogc3RyaW5nIHwgbnVsbDtcbiAgc2NhbGU6IG51bWJlcjtcbiAgb2Zmc2V0OiBudW1iZXI7XG4gIGlzQW5kcm9pZDogYm9vbGVhbjtcbiAgc3R5bGVzOiB7IHBhZGRpbmdUb3A6IG51bWJlcjsgcGFkZGluZ0JvdHRvbTogbnVtYmVyIH07XG59O1xuXG50eXBlIEFkalByb3BzID0gUGFkZGluZ1Byb3BzICYge1xuICBwYWQ6IG51bWJlcjtcbn07XG5cbmV4cG9ydCB0eXBlIFBhZGRpbmcgPSB7IHBhZGRpbmdUb3A6IG51bWJlcjsgcGFkZGluZ0JvdHRvbTogbnVtYmVyIH07XG5cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVMYWJlbFRvcFBvc2l0aW9uID0gKFxuICBsYWJlbEhlaWdodDogbnVtYmVyLFxuICBoZWlnaHQ6IG51bWJlciA9IDAsXG4gIG9wdGlvbmFsUGFkZGluZzogbnVtYmVyID0gMFxuKTogbnVtYmVyID0+IHtcbiAgY29uc3QgY3VzdG9tSGVpZ2h0ID0gaGVpZ2h0ID4gMCA/IGhlaWdodCA6IDA7XG5cbiAgcmV0dXJuIE1hdGguZmxvb3IoKGN1c3RvbUhlaWdodCAtIGxhYmVsSGVpZ2h0KSAvIDIgKyBvcHRpb25hbFBhZGRpbmcpO1xufTtcblxuZXhwb3J0IGNvbnN0IGNhbGN1bGF0ZUlucHV0SGVpZ2h0ID0gKFxuICBsYWJlbEhlaWdodDogbnVtYmVyLFxuICBoZWlnaHQ6IGFueSA9IDAsXG4gIG1pbkhlaWdodDogbnVtYmVyXG4pOiBudW1iZXIgPT4ge1xuICBjb25zdCBmaW5hbEhlaWdodCA9IGhlaWdodCA+IDAgPyBoZWlnaHQgOiBsYWJlbEhlaWdodDtcblxuICBpZiAoaGVpZ2h0ID4gMCkgcmV0dXJuIGhlaWdodDtcbiAgcmV0dXJuIGZpbmFsSGVpZ2h0IDwgbWluSGVpZ2h0ID8gbWluSGVpZ2h0IDogZmluYWxIZWlnaHQ7XG59O1xuXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlUGFkZGluZyA9IChwcm9wczogUGFkZGluZ1Byb3BzKTogbnVtYmVyID0+IHtcbiAgY29uc3QgeyBoZWlnaHQsIG11bHRpbGluZSA9IGZhbHNlIH0gPSBwcm9wcztcblxuICBsZXQgcmVzdWx0ID0gMDtcblxuICBpZiAobXVsdGlsaW5lKSB7XG4gICAgaWYgKGhlaWdodCAmJiBtdWx0aWxpbmUpIHtcbiAgICAgIHJlc3VsdCA9IGNhbGN1bGF0ZVRleHRBcmVhUGFkZGluZyhwcm9wcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdCA9IGNhbGN1bGF0ZUlucHV0UGFkZGluZyhwcm9wcyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIE1hdGgubWF4KDAsIHJlc3VsdCk7XG59O1xuXG5jb25zdCBjYWxjdWxhdGVUZXh0QXJlYVBhZGRpbmcgPSAocHJvcHM6IFBhZGRpbmdQcm9wcykgPT4ge1xuICBjb25zdCB7IGRlbnNlIH0gPSBwcm9wcztcblxuICByZXR1cm4gZGVuc2UgPyAxMCA6IDIwO1xufTtcblxuY29uc3QgY2FsY3VsYXRlSW5wdXRQYWRkaW5nID0gKHtcbiAgdG9wUG9zaXRpb24sXG4gIGZvbnRTaXplLFxuICBtdWx0aWxpbmUsXG4gIHNjYWxlLFxuICBkZW5zZSxcbiAgb2Zmc2V0LFxuICBpc0FuZHJvaWQsXG59OiBQYWRkaW5nUHJvcHMpOiBudW1iZXIgPT4ge1xuICBjb25zdCByZWZGb250U2l6ZSA9IHNjYWxlICogZm9udFNpemU7XG4gIGxldCByZXN1bHQgPSBNYXRoLmZsb29yKHRvcFBvc2l0aW9uIC8gMik7XG5cbiAgcmVzdWx0ID1cbiAgICByZXN1bHQgK1xuICAgIE1hdGguZmxvb3IoKHJlZkZvbnRTaXplIC0gZm9udFNpemUpIC8gMikgLVxuICAgIChzY2FsZSA8IDEgPyBvZmZzZXQgLyAyIDogMCk7XG5cbiAgaWYgKG11bHRpbGluZSAmJiBpc0FuZHJvaWQpXG4gICAgcmVzdWx0ID0gTWF0aC5taW4oZGVuc2UgPyBvZmZzZXQgLyAyIDogb2Zmc2V0LCByZXN1bHQpO1xuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgYWRqdXN0UGFkZGluZ091dCA9ICh7XG4gIHBhZCxcbiAgbXVsdGlsaW5lLFxuICBsYWJlbCxcbiAgc2NhbGUsXG4gIGhlaWdodCxcbiAgZm9udFNpemUsXG4gIGRlbnNlLFxuICBvZmZzZXQsXG4gIGlzQW5kcm9pZCxcbn06IEFkalByb3BzKTogUGFkZGluZyA9PiB7XG4gIGNvbnN0IHJlZkZvbnRTaXplID0gc2NhbGUgKiBmb250U2l6ZTtcbiAgbGV0IHJlc3VsdCA9IHBhZDtcblxuICBpZiAoaGVpZ2h0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhZGRpbmdUb3A6IE1hdGgubWF4KDAsIChoZWlnaHQgLSBmb250U2l6ZSkgLyAyKSxcbiAgICAgIHBhZGRpbmdCb3R0b206IE1hdGgubWF4KDAsIChoZWlnaHQgLSBmb250U2l6ZSkgLyAyKSxcbiAgICB9O1xuICB9XG4gIGlmICghaXNBbmRyb2lkICYmIG11bHRpbGluZSkge1xuICAgIGlmIChkZW5zZSkge1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIHJlc3VsdCArPSBzY2FsZSA8IDEgPyBNYXRoLm1pbihvZmZzZXQsIChyZWZGb250U2l6ZSAvIDIpICogc2NhbGUpIDogMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCArPSAwO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWRlbnNlKSB7XG4gICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgcmVzdWx0ICs9XG4gICAgICAgICAgc2NhbGUgPCAxXG4gICAgICAgICAgICA/IE1hdGgubWluKG9mZnNldCwgcmVmRm9udFNpemUgKiBzY2FsZSlcbiAgICAgICAgICAgIDogTWF0aC5taW4ob2Zmc2V0IC8gMiwgcmVmRm9udFNpemUgKiBzY2FsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgKz0gc2NhbGUgPCAxID8gTWF0aC5taW4ob2Zmc2V0IC8gMiwgcmVmRm9udFNpemUgKiBzY2FsZSkgOiAwO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQgPSBNYXRoLmZsb29yKHJlc3VsdCk7XG4gIH1cbiAgcmV0dXJuIHsgcGFkZGluZ1RvcDogcmVzdWx0LCBwYWRkaW5nQm90dG9tOiByZXN1bHQgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZGp1c3RQYWRkaW5nRmxhdCA9ICh7XG4gIHBhZCxcbiAgc2NhbGUsXG4gIG11bHRpbGluZSxcbiAgbGFiZWwsXG4gIGhlaWdodCxcbiAgb2Zmc2V0LFxuICBkZW5zZSxcbiAgZm9udFNpemUsXG4gIGlzQW5kcm9pZCxcbiAgc3R5bGVzLFxufTogQWRqUHJvcHMpOiBQYWRkaW5nID0+IHtcbiAgbGV0IHJlc3VsdCA9IHBhZDtcbiAgbGV0IHRvcFJlc3VsdCA9IHJlc3VsdDtcbiAgbGV0IGJvdHRvbVJlc3VsdCA9IHJlc3VsdDtcbiAgY29uc3QgeyBwYWRkaW5nVG9wLCBwYWRkaW5nQm90dG9tIH0gPSBzdHlsZXM7XG4gIGNvbnN0IHJlZkZvbnRTaXplID0gc2NhbGUgKiBmb250U2l6ZTtcblxuICBpZiAoIW11bHRpbGluZSkge1xuICAgIC8vIGRvIG5vdCBtb2RpZnkgcGFkZGluZyBpZiBpbnB1dCBpcyBub3QgbXVsdGlsaW5lXG4gICAgaWYgKGxhYmVsKSB7XG4gICAgICAvLyByZXR1cm4gY29uc3Qgc3R5bGUgZm9yIGZsYXQgaW5wdXQgd2l0aCBsYWJlbFxuICAgICAgcmV0dXJuIHsgcGFkZGluZ1RvcCwgcGFkZGluZ0JvdHRvbSB9O1xuICAgIH1cbiAgICAvLyByZXR1cm4gcGFkIGZvciBmbGF0IGlucHV0IHdpdGhvdXQgbGFiZWxcbiAgICByZXR1cm4geyBwYWRkaW5nVG9wOiByZXN1bHQsIHBhZGRpbmdCb3R0b206IHJlc3VsdCB9O1xuICB9XG5cbiAgaWYgKGxhYmVsKSB7XG4gICAgLy8gYWRkIHBhZGRpbmdzIHBhc3NlZCBmcm9tIHN0eWxlc1xuICAgIHRvcFJlc3VsdCA9IHBhZGRpbmdUb3A7XG4gICAgYm90dG9tUmVzdWx0ID0gcGFkZGluZ0JvdHRvbTtcblxuICAgIC8vIGFkanVzdCB0b3AgcGFkZGluZyBmb3IgaU9TXG4gICAgaWYgKCFpc0FuZHJvaWQpIHtcbiAgICAgIGlmIChkZW5zZSkge1xuICAgICAgICB0b3BSZXN1bHQgKz1cbiAgICAgICAgICBzY2FsZSA8IDFcbiAgICAgICAgICAgID8gTWF0aC5taW4ocmVzdWx0LCByZWZGb250U2l6ZSAqIHNjYWxlKSAtIHJlc3VsdCAvIDJcbiAgICAgICAgICAgIDogTWF0aC5taW4ocmVzdWx0LCByZWZGb250U2l6ZSAqIHNjYWxlKSAtIHJlc3VsdCAvIDI7XG4gICAgICB9XG4gICAgICBpZiAoIWRlbnNlKSB7XG4gICAgICAgIHRvcFJlc3VsdCArPVxuICAgICAgICAgIHNjYWxlIDwgMVxuICAgICAgICAgICAgPyBNYXRoLm1pbihvZmZzZXQgLyAyLCByZWZGb250U2l6ZSAqIHNjYWxlKVxuICAgICAgICAgICAgOiBNYXRoLm1pbihyZXN1bHQsIHJlZkZvbnRTaXplICogc2NhbGUpIC0gb2Zmc2V0IC8gMjtcbiAgICAgIH1cbiAgICB9XG4gICAgdG9wUmVzdWx0ID0gTWF0aC5mbG9vcih0b3BSZXN1bHQpO1xuICB9IGVsc2Uge1xuICAgIGlmIChoZWlnaHQpIHtcbiAgICAgIC8vIGNlbnRlciB0ZXh0IHdoZW4gaGVpZ2h0IGlzIHBhc3NlZFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGFkZGluZ1RvcDogTWF0aC5tYXgoMCwgKGhlaWdodCAtIGZvbnRTaXplKSAvIDIpLFxuICAgICAgICBwYWRkaW5nQm90dG9tOiBNYXRoLm1heCgwLCAoaGVpZ2h0IC0gZm9udFNpemUpIC8gMiksXG4gICAgICB9O1xuICAgIH1cbiAgICAvLyBhZGp1c3QgcGFkZGluZ3MgZm9yIGlPUyBpZiBubyBsYWJlbFxuICAgIGlmICghaXNBbmRyb2lkKSB7XG4gICAgICBpZiAoZGVuc2UpIHtcbiAgICAgICAgcmVzdWx0ICs9XG4gICAgICAgICAgc2NhbGUgPCAxXG4gICAgICAgICAgICA/IE1hdGgubWluKG9mZnNldCAvIDIsIChmb250U2l6ZSAvIDIpICogc2NhbGUpXG4gICAgICAgICAgICA6IE1hdGgubWluKG9mZnNldCAvIDIsIHNjYWxlKTtcbiAgICAgIH1cbiAgICAgIGlmICghZGVuc2UpIHtcbiAgICAgICAgcmVzdWx0ICs9XG4gICAgICAgICAgc2NhbGUgPCAxXG4gICAgICAgICAgICA/IE1hdGgubWluKG9mZnNldCwgZm9udFNpemUgKiBzY2FsZSlcbiAgICAgICAgICAgIDogTWF0aC5taW4oZm9udFNpemUsIChvZmZzZXQgLyAyKSAqIHNjYWxlKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0ID0gTWF0aC5mbG9vcihyZXN1bHQpO1xuICAgICAgdG9wUmVzdWx0ID0gcmVzdWx0O1xuICAgICAgYm90dG9tUmVzdWx0ID0gcmVzdWx0O1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcGFkZGluZ1RvcDogTWF0aC5tYXgoMCwgdG9wUmVzdWx0KSxcbiAgICBwYWRkaW5nQm90dG9tOiBNYXRoLm1heCgwLCBib3R0b21SZXN1bHQpLFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGludGVycG9sYXRlUGxhY2Vob2xkZXIgPSAoXG4gIGxhYmVsZWQ6IEFuaW1hdGVkLlZhbHVlLFxuICBoYXNBY3RpdmVPdXRsaW5lOiBib29sZWFuIHwgdW5kZWZpbmVkXG4pID0+XG4gIGxhYmVsZWQuaW50ZXJwb2xhdGUoe1xuICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICBvdXRwdXRSYW5nZTogW2hhc0FjdGl2ZU91dGxpbmUgPyAwIDogMSwgMV0sXG4gIH0pO1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRmxhdEFmZml4VG9wUG9zaXRpb24oe1xuICBoZWlnaHQsXG4gIHBhZGRpbmdUb3AsXG4gIHBhZGRpbmdCb3R0b20sXG4gIGFmZml4SGVpZ2h0LFxufToge1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgcGFkZGluZ1RvcDogbnVtYmVyO1xuICBwYWRkaW5nQm90dG9tOiBudW1iZXI7XG4gIGFmZml4SGVpZ2h0OiBudW1iZXI7XG59KTogbnVtYmVyIHtcbiAgY29uc3QgaW5wdXRIZWlnaHRXaXRob3V0UGFkZGluZyA9IGhlaWdodCAtIHBhZGRpbmdUb3AgLSBwYWRkaW5nQm90dG9tO1xuXG4gIGNvbnN0IGhhbGZPZlRoZUlucHV0SGVpZ2h0RGVjcmVhc2VkQnlBZmZpeEhlaWdodCA9XG4gICAgKGlucHV0SGVpZ2h0V2l0aG91dFBhZGRpbmcgLSBhZmZpeEhlaWdodCkgLyAyO1xuXG4gIHJldHVybiBwYWRkaW5nVG9wICsgaGFsZk9mVGhlSW5wdXRIZWlnaHREZWNyZWFzZWRCeUFmZml4SGVpZ2h0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlT3V0bGluZWRJY29uQW5kQWZmaXhUb3BQb3NpdGlvbih7XG4gIGhlaWdodCxcbiAgYWZmaXhIZWlnaHQsXG4gIGxhYmVsWU9mZnNldCxcbn06IHtcbiAgaGVpZ2h0OiBudW1iZXI7XG4gIGFmZml4SGVpZ2h0OiBudW1iZXI7XG4gIGxhYmVsWU9mZnNldDogbnVtYmVyO1xufSk6IG51bWJlciB7XG4gIHJldHVybiAoaGVpZ2h0IC0gYWZmaXhIZWlnaHQgKyBsYWJlbFlPZmZzZXQpIC8gMjtcbn1cblxuZXhwb3J0IGNvbnN0IGNhbGN1bGF0ZUZsYXRJbnB1dEhvcml6b250YWxQYWRkaW5nID0gKHtcbiAgYWRvcm5tZW50Q29uZmlnLFxufToge1xuICBhZG9ybm1lbnRDb25maWc6IEFkb3JubWVudENvbmZpZ1tdO1xufSkgPT4ge1xuICBsZXQgcGFkZGluZ0xlZnQgPSBMQUJFTF9QQURESU5HX0hPUklaT05UQUw7XG4gIGxldCBwYWRkaW5nUmlnaHQgPSBMQUJFTF9QQURESU5HX0hPUklaT05UQUw7XG5cbiAgYWRvcm5tZW50Q29uZmlnLmZvckVhY2goKHsgdHlwZSwgc2lkZSB9KSA9PiB7XG4gICAgaWYgKHR5cGUgPT09IEFkb3JubWVudFR5cGUuSWNvbiAmJiBzaWRlID09PSBBZG9ybm1lbnRTaWRlLkxlZnQpIHtcbiAgICAgIHBhZGRpbmdMZWZ0ID0gQURPUk5NRU5UX1NJWkUgKyBBRE9STk1FTlRfT0ZGU0VUICsgRkxBVF9JTlBVVF9PRkZTRVQ7XG4gICAgfSBlbHNlIGlmIChzaWRlID09PSBBZG9ybm1lbnRTaWRlLlJpZ2h0KSB7XG4gICAgICBpZiAodHlwZSA9PT0gQWRvcm5tZW50VHlwZS5BZmZpeCkge1xuICAgICAgICBwYWRkaW5nUmlnaHQgPSBBRE9STk1FTlRfU0laRSArIEFET1JOTUVOVF9PRkZTRVQgKyBGTEFUX0lOUFVUX09GRlNFVDtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gQWRvcm5tZW50VHlwZS5JY29uKSB7XG4gICAgICAgIHBhZGRpbmdSaWdodCA9IEFET1JOTUVOVF9TSVpFICsgQURPUk5NRU5UX09GRlNFVCArIEZMQVRfSU5QVVRfT0ZGU0VUO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHsgcGFkZGluZ0xlZnQsIHBhZGRpbmdSaWdodCB9O1xufTtcbiJdfQ==